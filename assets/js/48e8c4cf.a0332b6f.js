"use strict";(self.webpackChunkmeteoscientific=self.webpackChunkmeteoscientific||[]).push([[1038],{8:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-initial-tunnel-setup-route-setup-f766d8145e231d5cb8be5012a20207dc.png"},273:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-policy-configure-a6d616a596b08ecb33b227eb59f17f93.png"},426:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/LDDS75-working-on-MetSci-e8affb042ea528d31249b1b3f608dc09.png"},866:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/metsci-applications-integrations-tab-33c3cbc5a92fef65662ac1dc2d00f406.png"},1308:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/set-up-cloudflare-tunnel-36ae00c1ee990dc76ef0ef5a5bab33d4.png"},1353:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/node-red-busylight-trigger-flow-1dddb3b4f9d385b8e9570e5d94b72902.png"},1496:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/node-red-full-flow-0d230113fa5c9dd3cd5dabacf12daa48.png"},1581:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/tunnel-success-872fe72f263426a840648f0e1e9bed09.png"},1842:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/grafana-connections-influxdb-70aa66f6b6c0a093306f546b35abe717.png"},2058:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/ldds-75-jumper-power-off-303383f4668f118a24c3078f770006a0.jpeg"},2174:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/nik-throwing-the-horns-on-a-fully-installed-ldds75-sensor-using-helium-28a392bdab963bab830d170417415e0a.JPG"},2921:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-add-public-hostname-grafana-f1cd92d86ff97895df745b2daa274bc4.png"},3059:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-global-application-b7a68ae2a09c07c8b6065d46c1c4de44.png"},3079:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/go-to-zero-trust-1d2e00c4df76d081e8c0e82c4186002c.png"},3255:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/node-red-flow-with-debug-deploy-5e7e43219b8e0519db44de420ef09eb2.png"},3881:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/node-red-influxdb-out-node-configure-312f78b9b42fa4ffe4dfd98b4a04e834.png"},3914:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/node-red-switch-node-config-5e3cdaf12e435158d7b4a3196fb5c1fe.png"},4138:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/raspberry-pi-with-ssd-closet-680aa2f792c8b8639ba91d0af25b1c71.png"},4242:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-configure-service-auth-token-ldds75-161082be8e832d27b725b0a9be455cbc.png"},4486:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/install-and-run-connector-f960bf726a7e1d1ef871a2f72073aed1.png"},4608:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-grafana-access-control-0c0be2d1134ccd4e40b4be528a979671.png"},4716:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var i=s(4848),t=s(8453);const o={sidebar_position:4,title:"MetSci Demo Dashboard"},r="Build a Custom Dashboard",a={id:"tutorial-extras/metsci-demo-dash",title:"MetSci Demo Dashboard",description:"Ok nerds, let's do something rad with Helium and build a dashboard for a sensor.",source:"@site/docs/tutorial-extras/004-metsci-demo-dash.md",sourceDirName:"tutorial-extras",slug:"/tutorial-extras/metsci-demo-dash",permalink:"/docs/tutorial-extras/metsci-demo-dash",draft:!1,unlisted:!1,editUrl:"https://github.com/gristlekinginc/metsci-site-v2/tree/main/docs/tutorial-extras/004-metsci-demo-dash.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,title:"MetSci Demo Dashboard"},sidebar:"tutorialSidebar",previous:{title:"Integrating Google Sheets",permalink:"/docs/tutorial-extras/Google_Sheets"},next:{title:"Spreading Factor & Chirps",permalink:"/docs/tutorial-extras/spreading-factor-chirps"}},l={},d=[{value:"Get After It",id:"get-after-it",level:3},{value:"A. Hardware",id:"a-hardware",level:3},{value:"1. Core Development Hardware, ~$150 (use this for your next 50 projects)",id:"1-core-development-hardware-150-use-this-for-your-next-50-projects",level:4},{value:"2. Sensor, $60-80",id:"2-sensor-60-80",level:4},{value:"B. Not-Hardware",id:"b-not-hardware",level:3},{value:"C. Notes on what you &quot;Need&quot;",id:"c-notes-on-what-you-need",level:3},{value:"1. Set Up Overview",id:"1-set-up-overview",level:2},{value:"2. <strong>Setting Up Your Rasbperry Pi</strong>",id:"2-setting-up-your-rasbperry-pi",level:2},{value:"A. Basic Setup",id:"a-basic-setup",level:3},{value:"B. Securing Your Pi",id:"b-securing-your-pi",level:3},{value:"3. <strong>Install Services (Node-RED, InfluxDB, Grafana)</strong>",id:"3-install-services-node-red-influxdb-grafana",level:2},{value:"A. Service Install Script",id:"a-service-install-script",level:3},{value:"B. Integrate External SSD",id:"b-integrate-external-ssd",level:3},{value:"4. <strong>Cloudflare:</strong> Tunnels, Applications, and Tokens",id:"4-cloudflare-tunnels-applications-and-tokens",level:2},{value:"A. Set Up Zero Trust",id:"a-set-up-zero-trust",level:3},{value:"B. Zero Trust Token &amp; Application Setup",id:"b-zero-trust-token--application-setup",level:3},{value:"1. Create Service Tokens",id:"1-create-service-tokens",level:4},{value:"C. Zero Trust Applications",id:"c-zero-trust-applications",level:3},{value:"Node-RED Applications",id:"node-red-applications",level:4},{value:"Node-RED Application - Global",id:"node-red-application---global",level:4},{value:"Node-RED Policy Rule - Global",id:"node-red-policy-rule---global",level:4},{value:"Node-RED Application - LDDS75",id:"node-red-application---ldds75",level:4},{value:"Node-RED Policy Rule - LDDS75",id:"node-red-policy-rule---ldds75",level:4},{value:"Grafana Applications",id:"grafana-applications",level:4},{value:"Grafana Application &amp; Policy - Access Control",id:"grafana-application--policy---access-control",level:4},{value:"Grafana Application &amp; Policy - Public Access",id:"grafana-application--policy---public-access",level:4},{value:"D. Prepare Your Pi for Cloudflare",id:"d-prepare-your-pi-for-cloudflare",level:3},{value:"E. Create a Tunnel In Cloudflare Zero Trust",id:"e-create-a-tunnel-in-cloudflare-zero-trust",level:3},{value:"F. Add The Tunnel To Your Raspberry Pi",id:"f-add-the-tunnel-to-your-raspberry-pi",level:3},{value:"G. Setting Up Public Hostnames",id:"g-setting-up-public-hostnames",level:3},{value:"1. Node-RED Subdomain",id:"1-node-red-subdomain",level:4},{value:"2. Grafana Subdomain",id:"2-grafana-subdomain",level:4},{value:"H. Document Your Public Hostnames",id:"h-document-your-public-hostnames",level:3},{value:"5. <strong>Setting Up Your LDDS 75 Sensor</strong>",id:"5-setting-up-your-ldds-75-sensor",level:2},{value:"A. Provision That Sucker!",id:"a-provision-that-sucker",level:3},{value:"B. Check Link Metrics",id:"b-check-link-metrics",level:3},{value:"C. Configure For Fast Firing",id:"c-configure-for-fast-firing",level:3},{value:"D. Set Up The HTTP Integration In MetSci",id:"d-set-up-the-http-integration-in-metsci",level:3},{value:"6. <strong>Local Integration Setup</strong>",id:"6-local-integration-setup",level:2},{value:"A. Node-RED Flows",id:"a-node-red-flows",level:3},{value:"1. HTTP In",id:"1-http-in",level:4},{value:"2. HTTPS Response",id:"2-https-response",level:4},{value:"3. JSON",id:"3-json",level:4},{value:"4. Switch",id:"4-switch",level:4},{value:"5. Function",id:"5-function",level:4},{value:"6. InfluxDB out",id:"6-influxdb-out",level:4},{value:"7. Debug",id:"7-debug",level:4},{value:"8. Deploy and test",id:"8-deploy-and-test",level:4},{value:"B. InfluxDB Check",id:"b-influxdb-check",level:3},{value:"C. Grafana Dashboards",id:"c-grafana-dashboards",level:3},{value:"D. Fun with Monitoring &amp; Triggers",id:"d-fun-with-monitoring--triggers",level:3},{value:"1. Indoor Environment Monitoring",id:"1-indoor-environment-monitoring",level:4},{value:"2. Home Assistant Integration",id:"2-home-assistant-integration",level:4},{value:"3. Class C Integration",id:"3-class-c-integration",level:4},{value:"7. System Maintenance &amp; Troubleshooting",id:"7-system-maintenance--troubleshooting",level:2},{value:"A. Credentials Management",id:"a-credentials-management",level:3},{value:"B. Backing Up Configurations",id:"b-backing-up-configurations",level:3},{value:"C. System Updates",id:"c-system-updates",level:3},{value:"D. Troubleshooting Guide",id:"d-troubleshooting-guide",level:3},{value:"1. Service Not Starting",id:"1-service-not-starting",level:4},{value:"2. Lost Connection to Pi",id:"2-lost-connection-to-pi",level:4},{value:"3. Data Not Flowing",id:"3-data-not-flowing",level:4},{value:"4. Disk Space Issues",id:"4-disk-space-issues",level:4},{value:"8. La Ultima",id:"8-la-ultima",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"build-a-custom-dashboard",children:"Build a Custom Dashboard"}),"\n",(0,i.jsxs)(n.p,{children:["Ok nerds, let's do something rad with ",(0,i.jsx)(n.a,{href:"https://www.helium.com/",children:"Helium"})," and build a dashboard for a sensor."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"You don't actually have to be a nerd to do this."})," As long as you can get the hardware listed below, follow directions, and copy/paste, you're going to end up with a working dashboard."]}),"\n",(0,i.jsx)(n.p,{children:"When you're done, this'll be something you can share with your friends to let them know when the rain barrel is full (or if you're Joey's friends, when the sauna is hot)!"}),"\n",(0,i.jsxs)(n.p,{children:["I know, I know, you could use a ready-made service like ",(0,i.jsx)(n.a,{href:"https://datacake.de",children:"Datacake"})," for public dashbaords, but...we're nerds, and wherever possible we build our own things."]}),"\n",(0,i.jsx)(n.p,{children:"Relax, it won't be super hard.  We'll use a few scripts to make installing things secure and easy, so they just \"work\"."}),"\n",(0,i.jsx)(n.p,{children:"My goal here is to enable a non-technical person to build your own \"no-subscription\" public or private dashboards for about $200, most of which you'll spend on equipment you'll use in every other IoT project you do."}),"\n",(0,i.jsx)(n.p,{children:"IoT stuff has been super fun for me to explore, and I'm pumped to share it with you.  This is pretty much a love letter to you from me about IoT."}),"\n",(0,i.jsx)(n.p,{children:"Enjoy!"}),"\n",(0,i.jsx)(n.h3,{id:"get-after-it",children:"Get After It"}),"\n",(0,i.jsx)(n.p,{children:"Make sure you have the following on hand:"}),"\n",(0,i.jsx)(n.h3,{id:"a-hardware",children:"A. Hardware"}),"\n",(0,i.jsx)(n.h4,{id:"1-core-development-hardware-150-use-this-for-your-next-50-projects",children:"1. Core Development Hardware, ~$150 (use this for your next 50 projects)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://amzn.to/3DAVCnO",children:"Rasbperry Pi 4 with 4 or 8 GB RAM"}),", about $60."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://amzn.to/40ha8K5",children:"SD Card for Pi"}),", about $10"]}),"\n",(0,i.jsxs)(n.li,{children:["External SSD for the Pi, about $30.  IoT data sets can get pretty big and you'll want plenty of space beyond the SD card on the Pi.  SD cards can also wear out if you write to 'em a bunch. Something like ",(0,i.jsx)(n.a,{href:"https://amzn.to/3PbhbNY",children:"this"})," is fine."]}),"\n",(0,i.jsxs)(n.li,{children:["USB-TTL adapter (the thing that allows you to communicate directly over-the-wire with the sensor)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://buspirate.com/",children:"BusPirate"}),"  This is what the mighty Teague uses, and I recommend it. I used the v5 for this, but the v6 is already out!  $40-80"]}),"\n",(0,i.jsxs)(n.li,{children:["Cheapie ",(0,i.jsx)(n.a,{href:"https://www.amazon.com/dp/B07VNVVXW6?ref=ppx_pop_mob_ap_share",children:"Amazon Kit"})," (thanks to GreyHat for the rec) $14"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://www.sparkfun.com/products/24078",children:"Segger J-Link EDU Mini"})," - $60 on Sparkfun"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["2 x ",(0,i.jsx)(n.a,{href:"https://amzn.to/4aoqS5N",children:"USB A to USB C cables"})," (connecting the Pi to the SD card and the Bus Pirate to your computer)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://amzn.to/4h0Jn2w",children:"Dupont wires"})," for connecting the Bus Pirate to the sensor - $7"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["If you want a fancy case for your Pi (NOT needed), this is what I use: ",(0,i.jsx)(n.a,{href:"https://amzn.to/3E9OEpM",children:"FLIRC case"})," for Raspberry Pi 4B, about $16"]})}),"\n",(0,i.jsx)(n.h4,{id:"2-sensor-60-80",children:"2. Sensor, $60-80"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Dragino LDDS 75 sensor.  You can buy one at ",(0,i.jsx)(n.a,{href:"https://www.robotshop.com/products/dragino-ldds75-lorawan-distance-detection-sensor-915-mhz",children:"RobotShop"})," for $60-80."]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"The Pi, SD, SSD, and USB cables are Amazon affiliate links.  If 300 of you use those I'll probably be able to pay half my annual $12 domain name bill with the commissions."}),"\n",(0,i.jsxs)(n.li,{children:["I'm doing this whole thing on a Mac.  If you're on Windows, there'll be a couple commands that are slightly different, usually stuff like using ",(0,i.jsx)(n.code,{children:"CMD"})," instead of ",(0,i.jsx)(n.code,{children:"CTRL"}),".  I'll try to call them out as we go."]}),"\n"]})}),"\n",(0,i.jsx)(n.h3,{id:"b-not-hardware",children:"B. Not-Hardware"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Custom domain.  For this tutorial I'll be using mine, ",(0,i.jsx)(n.code,{children:"gristleking.dev"}),".  If you don't already have a domain, I'd ",(0,i.jsx)(n.strong,{children:"strongly"})," recommend buying one at ",(0,i.jsx)(n.a,{href:"https://cloudflare.com",children:"Cloudflare"}),".  They're about $12/year and buying it there makes everything else a little bit easier."]}),"\n",(0,i.jsx)(n.li,{children:"If you have a domain already, you'll need to set up your domain's name servers to point to Cloudflare."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"c-notes-on-what-you-need",children:'C. Notes on what you "Need"'}),"\n",(0,i.jsx)(n.p,{children:"You don't actually NEED a USB-TTL adapter, but it's generally good practice to have one hanging around the work bench if you're any kind of aspiring nerd.  You could use downlinks instead of the adapter to make changes to your sensor, but in practice I've found that to add both complication and time (especially if you have to wait for the next uplink & you get your downlink command wrong...ask me how I know)"}),"\n",(0,i.jsxs)(n.p,{children:["You ",(0,i.jsx)(n.em,{children:"could"})," do this without a custom domain by hosting in the cloud and managing tunnels with Cloudflare, but then you're on the hook for cloud hosting, which is probably $6/month at the cheapest.  A domain is something like $70/year for an expensive ",(0,i.jsx)(n.code,{children:".ai"})," one and $12/year for a cheap one. Trust me, just buy a domain."]}),"\n",(0,i.jsx)(n.p,{children:"Having your own domain makes part of this workflow way simpler, plus it's just cool to have your own domain.  Ask Larry at Google or Steve at Apple.  Having a custom domain is cool."}),"\n",(0,i.jsx)(n.h2,{id:"1-set-up-overview",children:"1. Set Up Overview"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Set Up Your Rasbperry Pi:"})," Basic setup and security"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Install Services:"})," Node-RED, InfluxDB, Grafana, integrate external SSD."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cloudflare:"})," Set up tunnels, tokens, applications, and policies."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Sensor:"})," Get the sensor sending data through MetSci"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Local Integration Testing:"})," Node-RED flows, integrate InfluxDB, create Grafana dashboards."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"System Maintenance & Troubleshooting:"})," Keep it rolling smooth, yo."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"2-setting-up-your-rasbperry-pi",children:["2. ",(0,i.jsx)(n.strong,{children:"Setting Up Your Rasbperry Pi"})]}),"\n",(0,i.jsx)(n.h3,{id:"a-basic-setup",children:"A. Basic Setup"}),"\n",(0,i.jsxs)(n.p,{children:["Rather than re-writing (and constantly updating) this part, I'm going to suggest you ",(0,i.jsx)(n.a,{href:"https://www.raspberrypi.com/software/",children:"follow the official docs"})," for the first part of this and load ",(0,i.jsx)(n.strong,{children:"Raspberry Pi OS Lite (64-bit)"}),".  If you've never done it before, that's ok."]}),"\n",(0,i.jsx)(n.p,{children:'The basic flow is to write (or "flash") the OS onto an SD card using your computer, then plug the SD card into your Pi.  After that you\'ll find the Pi on your local network and you can SSH in.  All of those things have lots of tutorials on the internet already.'}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"Starting with a fresh OS install is recommended to avoid conflicts with existing packages."})}),"\n",(0,i.jsx)(n.p,{children:"Once you've set up your Pi, connect it to your local network (Ethernet/LAN cable strongly preferred over WiFi).  SSH in using Terminal, then update/upgrade with:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt update && sudo apt dist-upgrade -y && sudo apt autoremove -y\n"})}),"\n",(0,i.jsx)(n.h3,{id:"b-securing-your-pi",children:"B. Securing Your Pi"}),"\n",(0,i.jsx)(n.p,{children:"Your Pi can be made a bit more secure with a few commands.  We're going to wrap them all up into one.  This is going to get the latest security patches, make sure everything is up to date, then set some basic firewall rules."}),"\n",(0,i.jsx)(n.p,{children:"There's nothing ultra fancy in here, just generally good Pi housekeeping."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl -sSL meteoscientific.com/scripts/secure-pi.sh -o secure.sh && chmod +x secure.sh && sudo ./secure.sh\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Once you've run it to the end, it'll ask you if you want to reboot.  Just type in ",(0,i.jsx)(n.code,{children:"y"})," and hit ",(0,i.jsx)(n.code,{children:"Enter"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["If you want to make your Pi significantly more protected, set up keys instead of passwords.  Doing that is beyond the scope of this tutorial and is well covered on the interwebz in general.  I'd ",(0,i.jsx)(n.a,{href:"https://pimylifeup.com/raspberry-pi-ssh-keys/",children:"start here"})," if you need help (or have ChatGPT walk you through it)."]}),"\n",(0,i.jsx)(n.p,{children:"Let's move on to installing the services we need."}),"\n",(0,i.jsxs)(n.h2,{id:"3-install-services-node-red-influxdb-grafana",children:["3. ",(0,i.jsx)(n.strong,{children:"Install Services (Node-RED, InfluxDB, Grafana)"})]}),"\n",(0,i.jsx)(n.h3,{id:"a-service-install-script",children:"A. Service Install Script"}),"\n",(0,i.jsx)(n.p,{children:"Copy & paste the following command into your Pi's Terminal:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl -sSL meteoscientific.com/scripts/install-dashboard-v3.sh -o dashboard.sh && chmod +x dashboard.sh && sudo ./dashboard.sh\n"})}),"\n",(0,i.jsx)(n.p,{children:"During the installation you'll get a few questions and warnings."}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["If you have a 4GB RAM Pi, you'll see a warning message about performance.  This is just to clarify that if you want to run a shitload of sensors frequently you'll probablly be better with an 8GB RAM Pi.  For most people, ",(0,i.jsx)(n.strong,{children:"4GB is fine"})," and ",(0,i.jsx)(n.strong,{children:"8GB is overkill"}),"."]})}),"\n",(0,i.jsxs)(n.p,{children:['The script will set up your "Organization" name (used in the database).  The default is ',(0,i.jsx)(n.code,{children:"MeteoScientific"}),", feel free to change that if you'd like.  This is mostly a structural thing, so just use something descriptive."]}),"\n",(0,i.jsx)(n.p,{children:"It'll also set up a bunch of random sci-fi usernames for the various services."}),"\n",(0,i.jsx)(n.p,{children:"You can accept all the defaults and be fine, or feel free to change them if you want different user names.  Don't get too twisted up with it; again, the defaults are fine."}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"Make sure you copy down your credentials when you see 'em at the end.  They'll be saved to a file in your home directory just in case, but you really should copy them down and then delete that file before you move on."})}),"\n",(0,i.jsx)(n.p,{children:"After installation, visit your shiny new setups:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Node-RED: ",(0,i.jsx)(n.a,{href:"http://your-pi:1880",children:"http://your-pi:1880"})]}),"\n",(0,i.jsxs)(n.li,{children:["InfluxDB: ",(0,i.jsx)(n.a,{href:"http://your-pi:8086",children:"http://your-pi:8086"})]}),"\n",(0,i.jsxs)(n.li,{children:["Grafana: ",(0,i.jsx)(n.a,{href:"http://your-pi:3000",children:"http://your-pi:3000"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"DON'T skip copying down your credentials"})," (instructions are at the end of the script) and then deleting that file."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cat /home/<YOUR-USER>/metsci-credentials.txt\n"})}),"\n",(0,i.jsx)(n.p,{children:"That will print out your credentials, which you'll need to use later.  Save those somewhere safe, then delete the file with:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rm -rf /home/<YOUR-USER>/metsci-credentials.txt\n"})}),"\n",(0,i.jsx)(n.h3,{id:"b-integrate-external-ssd",children:"B. Integrate External SSD"}),"\n",(0,i.jsx)(n.p,{children:"Now that your services are installed, let's make sure InfluxDB is using the SSD."}),"\n",(0,i.jsx)(n.p,{children:"Using a USB cable, connect your external SSD to one of the USB 3.0 ports on your Pi. Here I'm using PoE to power and connect the Pi, and the SSD is just laid on top.  The case is a 3D print so I can mount the Pi on the wall in my server (and clothes) closet."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Raspberry Pi mounted on closet wall with SSD",src:s(4138).A+"",width:"2724",height:"2062"})}),"\n",(0,i.jsx)(n.p,{children:"Then, in your Terminal:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Verify the SSD is detected:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"lsblk\n"})}),"\n","You should see something like this:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"core@myrmytron:~ $ lsblk\n NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS\n sda           8:0    0 111.8G  0 disk \n \u2514\u2500sda1        8:1    0 111.8G  0 part \n mmcblk0     179:0    0 116.2G  0 disk \n \u251c\u2500mmcblk0p1 179:1    0   512M  0 part /boot/firmware\n \u2514\u2500mmcblk0p2 179:2    0 115.7G  0 part /\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["See how my sda lists ",(0,i.jsx)(n.code,{children:"sda1"}),"?  We'll use that ",(0,i.jsx)(n.code,{children:"sda1"})," in this next command; yours may be named differently."]}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["Mount the SSD to a permanent location, e.g., ",(0,i.jsx)(n.code,{children:"/mnt/ssd"}),":","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo mkdir -p /mnt/ssd\nsudo mount /dev/sda1 /mnt/ssd\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Set the ownership for your user.  In my case, that's ",(0,i.jsx)(n.code,{children:"core"}),".  You may have named yours different.  Replace ",(0,i.jsxs)(n.strong,{children:["core",":core"]})," with your user name.","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo chown -R core:core /mnt/ssd\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Open up ",(0,i.jsx)(n.code,{children:"/etc/fstab"})," so we can set this up for persistence.","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/fstab\n"})}),"\n","In your ",(0,i.jsx)(n.code,{children:"/etc/fstab"}),", add a line like this, replacing ",(0,i.jsx)(n.code,{children:"sda1"})," with the correct partition identifier from ",(0,i.jsx)(n.code,{children:"lsblk"})," above.","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"/dev/sda1 /mnt/ssd ext4 defaults 0 2\n"})}),"\n","Save and exit with ",(0,i.jsx)(n.code,{children:"CTRL-X"}),", then ",(0,i.jsx)(n.code,{children:"y"}),", then ",(0,i.jsx)(n.code,{children:"Enter"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Nice work!"}),"\n",(0,i.jsx)(n.p,{children:"Now make sure you did that right. Verify SSD with the following commands:"}),"\n",(0,i.jsx)(n.p,{children:"After mounting:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Check mount: ",(0,i.jsx)(n.code,{children:"lsblk"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# You should see your SSD mounted at /mnt/ssd\nNAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS\nsda           8:0    0 111.8G  0 disk \n\u2514\u2500sda1        8:1    0 111.8G  0 part /mnt/ssd\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Verify permissions:"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ls -l /mnt/ssd`\n"})}),"\n",(0,i.jsx)(n.p,{children:"You should see something like this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"total 16\ndrwx------ 2 core core 16384 Nov 30 14:41 lost+found\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"lost+found"})," directory is normal for a fresh ext4 filesystem."]}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Test write access:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"   touch /mnt/ssd/test.txt\n"})}),"\n",(0,i.jsx)(n.p,{children:"Verify it was created"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ls -l /mnt/ssd/test.txt\n"})}),"\n",(0,i.jsx)(n.p,{children:"You should see something like:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"-rw-r--r-- 1 core core 0 Jan 4 22:45 test.txt\n"})}),"\n",(0,i.jsx)(n.p,{children:"Clean up"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rm /mnt/ssd/test.txt\n"})}),"\n",(0,i.jsx)(n.p,{children:'If any of these commands fail with "permission denied", your ownership isn\'t set correctly.'}),"\n",(0,i.jsx)(n.p,{children:"Nice work, you've set up the major components of your dashboard.  Now let's set up the Cloudflare tunnel to securely move data between your Pi and the internet."}),"\n",(0,i.jsxs)(n.h2,{id:"4-cloudflare-tunnels-applications-and-tokens",children:["4. ",(0,i.jsx)(n.strong,{children:"Cloudflare:"})," Tunnels, Applications, and Tokens"]}),"\n",(0,i.jsxs)(n.p,{children:['Cloudflare provides a secure connection called a "tunnel" between your Pi and the internet.  Within a tunnel will be different public hostnames for different services, like ',(0,i.jsx)(n.code,{children:"node-red.gristleking.dev"})," for Node-RED and ",(0,i.jsx)(n.code,{children:"grafana.gristleking.dev"})," for Grafana.  We'll use those to connect our Pi to the internet in a secure way."]}),"\n",(0,i.jsx)(n.p,{children:"Think of a tunnel like a big PVC pipe that connects your Pi to the internet.  Within that pipe are lots of individual pipes that carry separate types of information to different places.  Each individualpipe is a public hostname in the tunnel, and within those pipes you'll split it out even further into different Applications that manage the data from different types of sensors."}),"\n",(0,i.jsx)(n.p,{children:"Cloudflare changes and updates all the time, so the screenshots and instructions below may be slightly different than what you see in Cloudflare."}),"\n",(0,i.jsx)(n.p,{children:"Before we set up the tunnel, we're going to build the access control we need to keep our Pi secure."}),"\n",(0,i.jsx)(n.h3,{id:"a-set-up-zero-trust",children:"A. Set Up Zero Trust"}),"\n",(0,i.jsxs)(n.p,{children:["To start this off, login to ",(0,i.jsx)(n.a,{href:"https://www.cloudflare.com/",children:"Cloudflare"}),". I'm assuming you've already set up your domain with Cloudflare, so when you log in you'll see something like this:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Cloudflare Dashboard",src:s(9859).A+"",width:"3188",height:"1358"})}),"\n",(0,i.jsx)(n.p,{children:"You'll need to set up your Zero Trust account in Cloudflare (relax, it's free)."}),"\n",(0,i.jsxs)(n.p,{children:["If you haven't set up Zero Trust yet, you may not see \"Zero Trust\" in your menu.  If that's the case, navigate to your domain name, look for ",(0,i.jsx)(n.code,{children:"Access"})," in the left menu, then hit the ",(0,i.jsx)(n.code,{children:"Launch Zero Trust"})," blue button on the right, then click it and set up Zero Trust."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Cloudflare Zero Trust",src:s(6765).A+"",width:"2564",height:"1724"})}),"\n",(0,i.jsxs)(n.p,{children:["Once you have it, you'll see it in your ",(0,i.jsx)(n.strong,{children:"Main"})," (not your domain) Cloudflare menu, like this."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Cloudflare Zero Trust",src:s(3079).A+"",width:"3114",height:"1574"})}),"\n",(0,i.jsx)(n.p,{children:"With Zero Trust on and ready to go, let's set up all the access control we need before connecting our Pi to the internet."}),"\n",(0,i.jsx)(n.h3,{id:"b-zero-trust-token--application-setup",children:"B. Zero Trust Token & Application Setup"}),"\n",(0,i.jsx)(n.p,{children:"With our public hostnames set up we'll need to protect them so that not every jackass and their brother can drop into our Node-RED or Grafana instances.  We'll do that with Cloudflare's Zero Trust."}),"\n",(0,i.jsx)(n.p,{children:"For each public hostname, we'll create Applications and Tokens to manage access for them.  In general, we don't want the public to have any access to our Node-RED instance, but we do want to share our Grafana dashboard with the public."}),"\n",(0,i.jsx)(n.p,{children:"Let's start with the Node-RED Application and Token, focusing on what we'll need for the LDDS75."}),"\n",(0,i.jsx)(n.p,{children:"We'll need three things in order to manage access in Cloudflare Zero Trust:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"1. A Service Token\n2. A Zero Trust Application\n3. A Zero Trust Policy Rule\n"})}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.p,{children:'The use of the word "Application" can be a bit confusing here, as we have both Cloudflare Applications and MetSci Applications.'}),(0,i.jsxs)(n.p,{children:["Remember, a ",(0,i.jsx)(n.code,{children:"MetSci Application"})," is a group of sensors that share the same data structure.  If you were monitoring 30 rainwater tanks with 30 LDDS75 sensors, all of the sensors would be in one MetSci Application, which would map to one ",(0,i.jsx)(n.code,{children:"Cloudflare Application"}),"."]}),(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.code,{children:"Cloudflare Application"})," is used to manage a Zero Trust setup.  In our case, we'll use ",(0,i.jsx)(n.code,{children:"Service Tokens"}),' as a gatekeeper ("No token no entry") as well as a routing requirement, where the LDDS75 token will help route all the LDDS75 data to the Node-RED instance.']})]}),"\n",(0,i.jsx)(n.h4,{id:"1-create-service-tokens",children:"1. Create Service Tokens"}),"\n",(0,i.jsxs)(n.p,{children:["In Cloudflare, back in Zero Trust, go to ",(0,i.jsx)(n.code,{children:"Access--\x3eService Auth"})," and click ",(0,i.jsx)(n.code,{children:"Create Service Token"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["We'll start with a Service Token for Node-RED.  Name your token something descriptive (I'll use ",(0,i.jsx)(n.code,{children:"ldds75"}),") and set the duration to ",(0,i.jsx)(n.code,{children:"Non-expiring"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Add a Service Token in Zero Trust",src:s(4242).A+"",width:"2320",height:"614"})}),"\n",(0,i.jsxs)(n.p,{children:["That will give you an ",(0,i.jsx)(n.code,{children:"Access ID"})," and an ",(0,i.jsx)(n.code,{children:"Access secret"}),".  Save ",(0,i.jsx)(n.strong,{children:"both the headers and the access codes"})," in a secure place.  We'll need them when we set up the HTTP integration in MetSci.  What you save should look like this:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"CF-Access-Client-Id: 5xxxxxxxxxxxxxxxxxxxxxxxx3.access\n\nCF-Access-Client-Secret: ffxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx2\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Hit the ",(0,i.jsx)(n.code,{children:"Save"})," button at the bottom right."]}),"\n",(0,i.jsxs)(n.p,{children:["Using that same process of ",(0,i.jsx)(n.code,{children:"Access--\x3eService Auth--\x3eCreate Service Token"}),", create another Service Token for Grafana.  I'll use ",(0,i.jsx)(n.code,{children:"grafana-admin"}),".  When you're finished, you'll have two Service Tokens, like this:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Two Service Tokens",src:s(7704).A+"",width:"2640",height:"812"})}),"\n",(0,i.jsx)(n.h3,{id:"c-zero-trust-applications",children:"C. Zero Trust Applications"}),"\n",(0,i.jsx)(n.p,{children:"We're going to set up 4 Applications.  Two for NOD-RED, and two for Grafana.  They'll do slightly different things, but the process of setting them up is the same."}),"\n",(0,i.jsx)(n.h4,{id:"node-red-applications",children:"Node-RED Applications"}),"\n",(0,i.jsxs)(n.p,{children:["Go to ",(0,i.jsx)(n.code,{children:"Access--\x3eApplications"})," and add a new Cloudflare Application."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Add a Zero Trust Application",src:s(6140).A+"",width:"2716",height:"1580"})}),"\n",(0,i.jsxs)(n.p,{children:["Select ",(0,i.jsx)(n.code,{children:"Self Hosted"})]}),"\n",(0,i.jsx)(n.p,{children:"In Node-RED, we don't want any public access, so we'll set up a global gatekeeper and then a specific application to allow our MetSci LDDS75 data to pass through."}),"\n",(0,i.jsx)(n.h4,{id:"node-red-application---global",children:"Node-RED Application - Global"}),"\n",(0,i.jsx)(n.p,{children:"Let's start with the global Node-RED application."}),"\n",(0,i.jsxs)(n.p,{children:["Set the Application name to ",(0,i.jsx)(n.code,{children:"Node-RED"})," and set the ",(0,i.jsx)(n.code,{children:"Session Duration"})," to ",(0,i.jsx)(n.code,{children:"24 hours"}),".  Then set the subdomain to ",(0,i.jsx)(n.code,{children:"node-red"}),", the ",(0,i.jsx)(n.code,{children:"domain"})," to ",(0,i.jsx)(n.code,{children:"<YOUR-DOMAIN>.com"}),", and the ",(0,i.jsx)(n.code,{children:"path"})," to ",(0,i.jsx)(n.code,{children:"*"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Add a global application",src:s(3059).A+"",width:"2318",height:"880"})}),"\n",(0,i.jsxs)(n.p,{children:["Scroll down to the bottom and click ",(0,i.jsx)(n.code,{children:"Next"})," to proceed to the ",(0,i.jsx)(n.code,{children:"Policies"})," section.  Here we'll set up a Policy rule that requires anything using this Application to have a valid token."]}),"\n",(0,i.jsx)(n.h4,{id:"node-red-policy-rule---global",children:"Node-RED Policy Rule - Global"}),"\n",(0,i.jsxs)(n.p,{children:["Set the policy name to ",(0,i.jsx)(n.code,{children:"Node-RED"})," and set the Action to ",(0,i.jsx)(n.code,{children:"Service Auth"}),", leave the duration as is."]}),"\n",(0,i.jsxs)(n.p,{children:["Scroll down a bit until you see ",(0,i.jsx)(n.code,{children:"Configure rules"}),".  On the Selector choose ",(0,i.jsx)(n.code,{children:"Any Access Service Token"}),".  It will automatically fill in a value of ",(0,i.jsx)(n.code,{children:"Any non expired Service Token will be matched"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Add a policy rule",src:s(6043).A+"",width:"2936",height:"1838"})}),"\n",(0,i.jsxs)(n.p,{children:["Hit ",(0,i.jsx)(n.code,{children:"Next"})," and scroll down to the bottom of the next page (past ",(0,i.jsx)(n.code,{children:"CORS"}),", ",(0,i.jsx)(n.code,{children:"Cookies"}),", and ",(0,i.jsx)(n.code,{children:"Additional Settings"}),"), then click ",(0,i.jsx)(n.code,{children:"Add Application"}),"."]}),"\n",(0,i.jsx)(n.h4,{id:"node-red-application---ldds75",children:"Node-RED Application - LDDS75"}),"\n",(0,i.jsxs)(n.p,{children:["Now you'll create the LDDS75 Application, which will only apply to our LDDS75 data.  Hit the ",(0,i.jsx)(n.code,{children:"Add Application"}),", then ",(0,i.jsx)(n.code,{children:"Self Hosted"})," (just like last time), then give it a descriptive name like ",(0,i.jsx)(n.code,{children:"ldds75"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Leave the session duration at ",(0,i.jsx)(n.code,{children:"24 hours"})," then enter the subdomain, domain, and path it'll use."]}),"\n",(0,i.jsxs)(n.p,{children:["In this case, use ",(0,i.jsx)(n.code,{children:"node-red"})," . ",(0,i.jsx)(n.code,{children:"gristleking.dev"})," / ",(0,i.jsx)(n.code,{children:"metsci-ldds75-data"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["We'll use the ",(0,i.jsx)(n.code,{children:"metsci-ldds75-data"})," path later when we set up our Node-RED flow."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Configure Zero Trust Appication",src:s(7007).A+"",width:"2750",height:"882"})}),"\n",(0,i.jsxs)(n.p,{children:["Scroll down past ",(0,i.jsx)(n.code,{children:"Application Appearances"})," and ",(0,i.jsx)(n.code,{children:"Tags"})," etc to the bottom."]}),"\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.code,{children:"Next"})," to proceed to the ",(0,i.jsx)(n.code,{children:"Policies"})," section."]}),"\n",(0,i.jsx)(n.h4,{id:"node-red-policy-rule---ldds75",children:"Node-RED Policy Rule - LDDS75"}),"\n",(0,i.jsxs)(n.p,{children:["We'll use the same ",(0,i.jsx)(n.code,{children:"Service Auth"})," policy as the global application, but this time we'll restrict it to the ",(0,i.jsx)(n.code,{children:"ldds75"})," token we've set up."]}),"\n",(0,i.jsxs)(n.p,{children:["Set the policy name to ",(0,i.jsx)(n.code,{children:"ldds75"})," and set the Action to ",(0,i.jsx)(n.code,{children:"Allow"}),", leave the duration as is."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Set up your policy",src:s(273).A+"",width:"2722",height:"1080"})}),"\n",(0,i.jsxs)(n.p,{children:["Scroll down to ",(0,i.jsx)(n.code,{children:"Configure rules"}),".  On the Selector choose ",(0,i.jsx)(n.code,{children:"Service Token"}),", then select the Service Token you just created."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Configure Policy for your LDDS75 Zero Trust Application",src:s(4918).A+"",width:"2574",height:"664"})}),"\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.code,{children:"Next"}),", then scroll through the next page, past CORS settings, Cookies settings, and Additional settings. Click ",(0,i.jsx)(n.code,{children:"Add Application"})," at the bottom right and you're done with the Node-RED Applications."]}),"\n",(0,i.jsx)(n.h4,{id:"grafana-applications",children:"Grafana Applications"}),"\n",(0,i.jsx)(n.p,{children:"Ok, now we'll set up the Grafana Applications.  Unlike Node-RED where we're blocking ALL access to the public, this time we want to block access to the Grafana admin side but allow public access to specific Grafana dashboards."}),"\n",(0,i.jsx)(n.p,{children:"Since you've already set up two Applications, I'll go a little faster."}),"\n",(0,i.jsx)(n.h4,{id:"grafana-application--policy---access-control",children:"Grafana Application & Policy - Access Control"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Zero Trust --\x3e Access --\x3e Applications --\x3e Add Application --\x3e Self Hosted"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Application name: `Grafana Access Control`\nSession Duration: `24 hours`\nSubdomain: `grafana`\nDomain: `<YOUR-DOMAIN>.com`\nPath: `*`\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Scroll down to the bottom and click ",(0,i.jsx)(n.code,{children:"Next"})," to proceed to the ",(0,i.jsx)(n.code,{children:"Policies"})," section."]}),"\n",(0,i.jsx)(n.p,{children:"Add a policy with the following:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Policy name: Token Auth\nAction: Service Auth\nSession Duration: Same as application session timeout\n\nScroll down and\n\nConfigure rules:\nInclude: Any Access Service Token\nValue: Any non expired Service Token will be matched\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Grafana Access Control Application",src:s(4608).A+"",width:"1200",height:"600"})}),"\n",(0,i.jsxs)(n.p,{children:["Scroll down to the bottom of the next page and click ",(0,i.jsx)(n.code,{children:"Add Application"}),".  You don't need to set up a specific Service Auth token for this, you just need to require that any service token is needed to access Grafana except for viewing public dashboards.  We'll set that Application and Policy up next."]}),"\n",(0,i.jsx)(n.h4,{id:"grafana-application--policy---public-access",children:"Grafana Application & Policy - Public Access"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Zero Trust --\x3e Access --\x3e Applications --\x3e Add Application --\x3e Self Hosted"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Application name: `Grafana Public Access`\nSession Duration: `24 hours`\nSubdomain: `grafana`\nDomain: `<YOUR-DOMAIN>.com`\nPath: `public*`\n"})}),"\n",(0,i.jsx)(n.p,{children:"Then add two more domains, with two different paths:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Add a Grafana Public Access Application",src:s(8290).A+"",width:"2010",height:"952"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"- Subdomain: `grafana`\n- Domain: `<YOUR-DOMAIN>.com`\n- Path: `public-dashboards*`\n"})}),"\n",(0,i.jsx)(n.p,{children:"and"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"- Subdomain: `grafana`\n- Domain: `<YOUR-DOMAIN>.com`\n- Path: `api/public*`\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Scroll down to the bottom and click ",(0,i.jsx)(n.code,{children:"Next"})," to proceed to the ",(0,i.jsx)(n.code,{children:"Policies"})," section."]}),"\n",(0,i.jsx)(n.p,{children:"Add a policy with the following:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Policy name: Bypass\nAction: Bypass\nSession Duration: Same as application session timeout\n\nScroll down and\n\nConfigure rules:\nInclude: Everyone\nValue: Everyone (will fill in automatically)\n"})}),"\n",(0,i.jsx)(n.p,{children:'Super, now you\'ve set up all your Cloudflare Applications and Policies.  The "gates" are setup, so now we can set up and connect the Cloudflare Tunnel to securely move data between your Pi and the internet.'}),"\n",(0,i.jsx)(n.h3,{id:"d-prepare-your-pi-for-cloudflare",children:"D. Prepare Your Pi for Cloudflare"}),"\n",(0,i.jsx)(n.p,{children:"In the Pi terminal, install Cloudflare Tunnel.  It's good practice when you're adding anything to your Pi to kick things off with a system update:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt update && sudo apt upgrade -y\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Now that the Pi is cleaned & ready, download the Cloudflare binary to the Pi.  I'm running a Pi 4B with 64-bit ARM architecture (use ",(0,i.jsx)(n.code,{children:"uname -m"})," to check yours if you're unsure), so here's the command I'm using:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"wget https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-arm64 -O cloudflared\n"})}),"\n",(0,i.jsx)(n.p,{children:"That may take a few minutes depending on your connection speed."}),"\n",(0,i.jsx)(n.p,{children:"When it's done, let's do a few nerdy things (making the binary executable, moving it to a system path, then verifying the installation)."}),"\n",(0,i.jsx)(n.p,{children:"Make it executable:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"chmod +x cloudflared\n"})}),"\n",(0,i.jsx)(n.p,{children:"Move it to a system directory:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo mv cloudflared /usr/local/bin/cloudflared\n"})}),"\n",(0,i.jsx)(n.p,{children:"Verify the installation:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cloudflared --version\n"})}),"\n",(0,i.jsx)(n.p,{children:"That should get you here on your Pi:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Cloudflare tunnel installed and ready to set up",src:s(1308).A+"",width:"1740",height:"270"})}),"\n",(0,i.jsx)(n.h3,{id:"e-create-a-tunnel-in-cloudflare-zero-trust",children:"E. Create a Tunnel In Cloudflare Zero Trust"}),"\n",(0,i.jsx)(n.p,{children:"With Cloudflare's Zero Trust on and our Pi set up, we're going to set up the actual tunnel."}),"\n",(0,i.jsxs)(n.p,{children:["Back in your Cloudflare account, in Zero Trust, go to ",(0,i.jsx)(n.code,{children:"Networks --\x3e Tunnels --\x3e Add a tunnel"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Zero Trust Network Tunnels",src:s(7290).A+"",width:"2546",height:"1170"})}),"\n",(0,i.jsxs)(n.p,{children:["On the next page (not shown here), select ",(0,i.jsx)(n.code,{children:"Cloudflared"}),", ",(0,i.jsx)(n.strong,{children:"NOT"})," ",(0,i.jsx)(n.code,{children:"WARP Connector"}),", then choose a tunnel name.  I'll use ",(0,i.jsx)(n.code,{children:"metsci-demo"})," for mine."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Name your Cloudflare tunnel",src:s(8519).A+"",width:"3310",height:"1382"})}),"\n",(0,i.jsxs)(n.p,{children:["Save the tunnel and you'll be taken to the ",(0,i.jsx)(n.code,{children:"Configure"})," page.  Look for the ",(0,i.jsx)(n.code,{children:"Install and Run Connector"})," section and copy the command on the right."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Install and run connector",src:s(4486).A+"",width:"2670",height:"1336"})}),"\n",(0,i.jsx)(n.h3,{id:"f-add-the-tunnel-to-your-raspberry-pi",children:"F. Add The Tunnel To Your Raspberry Pi"}),"\n",(0,i.jsx)(n.p,{children:"Back on your Pi, run the command they gave us:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"sudo cloudflared service install super-duper-alpha-numeric-string"})}),"\n",(0,i.jsx)(n.p,{children:"You should see a success message, like this."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Tunnel successfully installed",src:s(1581).A+"",width:"3184",height:"1902"})}),"\n",(0,i.jsxs)(n.p,{children:["Hit ",(0,i.jsx)(n.code,{children:"Next"})," at the bottom right of your Cloudflare Configure tunnel screen."]}),"\n",(0,i.jsx)(n.h3,{id:"g-setting-up-public-hostnames",children:"G. Setting Up Public Hostnames"}),"\n",(0,i.jsx)(n.p,{children:"With our tunnel set up, now we'll create our Public Hostnames (subdomains), starting with Node-RED."}),"\n",(0,i.jsx)(n.h4,{id:"1-node-red-subdomain",children:"1. Node-RED Subdomain"}),"\n",(0,i.jsxs)(n.p,{children:["Add ",(0,i.jsx)(n.code,{children:"node-red"})," in the Subdomain field, then choose your domain. I'm using ",(0,i.jsx)(n.code,{children:"gristleking.dev"})," for this tutorial.  Throughout the tutorial, wherever you see ",(0,i.jsx)(n.code,{children:"gristleking.dev"}),", replace it with your own domain."]}),"\n",(0,i.jsxs)(n.p,{children:["For Type choose ",(0,i.jsx)(n.code,{children:"HTTP"}),", then set the URL to ",(0,i.jsx)(n.code,{children:"localhost:1880"}),", which is the port Node-RED runs on."]}),"\n",(0,i.jsxs)(n.p,{children:["Now hit the blue ",(0,i.jsx)(n.code,{children:"Save tunnel"})," button at the bottom right."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Configure your initial public hostname",src:s(8).A+"",width:"2590",height:"1464"})}),"\n",(0,i.jsxs)(n.p,{children:["You'll be taken back to the Tunnels page.  Click on the three stacked dots on the right side of the row for your tunnel, then click ",(0,i.jsx)(n.code,{children:"Configure"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Adding a new public hostname to a Cloudflare Tunnel",src:s(6743).A+"",width:"3718",height:"782"})}),"\n",(0,i.jsx)(n.p,{children:"Now we'll set up the Grafana public hostname."}),"\n",(0,i.jsx)(n.h4,{id:"2-grafana-subdomain",children:"2. Grafana Subdomain"}),"\n",(0,i.jsxs)(n.p,{children:["Select ",(0,i.jsx)(n.code,{children:"Public Hostname"})," and click ",(0,i.jsx)(n.code,{children:"Add a public hostname"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Add a new public hostname",src:s(9482).A+"",width:"2592",height:"1126"})}),"\n",(0,i.jsxs)(n.p,{children:["Set it up the same way you did for Ned-RED, just subbing in ",(0,i.jsx)(n.code,{children:"grafana"})," and the correct port as follows:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"-Subdomain: grafana\n-Domain: <YOUR-DOMAIN>.com\n-Type: HTTP\n-URL: localhost:3000\n"})}),"\n",(0,i.jsx)(n.p,{children:"It should look like this:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Add the hostname and post for Grafana",src:s(2921).A+"",width:"2134",height:"328"})}),"\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.code,{children:"Save hostname"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"You can now see both your public hostnames for your tunnel.  Cool, right?"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Confirm both your public hostnames",src:s(6006).A+"",width:"2642",height:"840"})}),"\n",(0,i.jsx)(n.h3,{id:"h-document-your-public-hostnames",children:"H. Document Your Public Hostnames"}),"\n",(0,i.jsxs)(n.p,{children:["Head back to the Cloudflare main menu and choose your domain, then ",(0,i.jsx)(n.code,{children:"DNS"}),", then look for the subdomain you just set up.  I usually add a note to mine, something like ",(0,i.jsx)(n.code,{children:"this is for Node-RED for the MetSci Demo Dash project"}),", just so future me has a clue as to what's going on."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Add notes to your DNS records",src:s(6041).A+"",width:"3276",height:"1890"})}),"\n",(0,i.jsxs)(n.p,{children:["Now you've set it up so that you can share a dashboard via your Cloudflare tunnel, but the rest of your Grafana instance is still protected.  Big thanks to ",(0,i.jsx)(n.strong,{children:"Chaika"})," over on the Cloudflare Discord for walking me through the Grafana dashboard setup!"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"5-setting-up-your-ldds-75-sensor",children:["5. ",(0,i.jsx)(n.strong,{children:"Setting Up Your LDDS 75 Sensor"})]}),"\n",(0,i.jsxs)(n.p,{children:["Whether this is your first device ever or your 100th, now is a good time to think about how you're going to structure your data.  I've written a ",(0,i.jsx)(n.a,{href:"/docs/tutorial-basics/good-housekeeping-for-LoRaWAN-sensor-fleets",children:"separate tutorial just on structuring data"}),". If you've never thought about this before, it's a good idea to read through that.  You can also just YOLO and follow along, trusting that my data structure is good enough for you."]}),"\n",(0,i.jsx)(n.p,{children:"I'm not going to tell you what to do, but I will tell you that if you're going to be doing anything with your data, you're going to want to think about it."}),"\n",(0,i.jsx)(n.h3,{id:"a-provision-that-sucker",children:"A. Provision That Sucker!"}),"\n",(0,i.jsxs)(n.p,{children:["Use the ",(0,i.jsx)(n.a,{href:"/docs/tutorial-basics/adding-a-device",children:"Add A Device"})," tutorial on this site to walk you through it.  A working codec for the device is in MetSci already. When you're done, it should look like this:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"LDDS 75 reporting in the MetSci Chirpstack",src:s(426).A+"",width:"2582",height:"876"})}),"\n",(0,i.jsx)(n.h3,{id:"b-check-link-metrics",children:"B. Check Link Metrics"}),"\n",(0,i.jsx)(n.p,{children:"Ok, assuming you've got your data structure set up, after a while (for me this is about 3 weeks) your Link Metrics for the device will be pretty boring flat lines, like this:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"LDDS 75 Link Metrics",src:s(4819).A+"",width:"4672",height:"1574"})}),"\n",(0,i.jsxs)(n.p,{children:["Quick note:  You ",(0,i.jsx)(n.em,{children:"can't"})," see the ",(0,i.jsx)(n.strong,{children:"Device Metrics"})," properly in Chirpstack, which is what we're using for an LNS, as both the Battery Voltage and the Distance will be off the chart, which is 0 - 1.0, and unless you have the optional extra temp sensor you won't see that either.  Don't worry about seeing anything here; that's why we're setting up a dashboard.  \ud83d\udd27"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"LDDS 75 Link Metrics",src:s(4791).A+"",width:"4674",height:"1596"})}),"\n",(0,i.jsx)(n.h3,{id:"c-configure-for-fast-firing",children:"C. Configure For Fast Firing"}),"\n",(0,i.jsx)(n.p,{children:"We're going to need some data coming through the tunnel in a bit, so let's set up the LDDS75 to fire every minute for now, then we'll pull the power until we're ready to test."}),"\n",(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.a,{href:"/docs/tutorial-basics/configure-a-device",children:"this guide"}),' to set up the LDDS75 to fire every minute.  You "could" theoretically do all this with downlinks, but A) I\'m not covering that here and B) I want you to have the ability to wire into a sensor and tell it what to do.']}),"\n",(0,i.jsx)(n.p,{children:"However you do it..."}),"\n",(0,i.jsx)(n.p,{children:"Once you've got it set up and seen a few packets come through, pull the power on your LDDS75 using the yellow jumper; we'll use it again in a bit."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"LDDS 75 jumper",src:s(2058).A+"",width:"4032",height:"3024"})}),"\n",(0,i.jsx)(n.h3,{id:"d-set-up-the-http-integration-in-metsci",children:"D. Set Up The HTTP Integration In MetSci"}),"\n",(0,i.jsxs)(n.p,{children:["Head back over to the ",(0,i.jsx)(n.a,{href:"https://console.meteoscientific.com/front/login",children:"MeteoScientific Console"})," and in ",(0,i.jsx)(n.code,{children:"Applications"}),"--\x3e",(0,i.jsx)(n.code,{children:"LDDS 75"})," (or whatever you called it), look for the ",(0,i.jsx)(n.code,{children:"Integrations"})," tab."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"MetSci LDDS 75 Integrations",src:s(866).A+"",width:"2562",height:"1668"})}),"\n",(0,i.jsxs)(n.p,{children:["Find 'HTTP Integrations\" and hit the ",(0,i.jsx)(n.code,{children:"+"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Leave the payload encoding set to JSON."}),"\n",(0,i.jsxs)(n.p,{children:["Change the event endpoint to ",(0,i.jsx)(n.code,{children:"https://node-red.<YOUR-DOMAIN>/metsci-ldds75-data/"})," then add two headers:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"CF-Access-Client-ID <your-access-id>\nCF-Access-Client-Secret <your-access-secret>\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Use the ",(0,i.jsx)(n.code,{children:"Access ID"})," and ",(0,i.jsx)(n.code,{children:"Access Secret"})," from the Service Token you set up for the LDDS75 in Cloudflare."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Set up your http integration in MetSci Chirpstack",src:s(7958).A+"",width:"3266",height:"1256"})}),"\n",(0,i.jsx)(n.p,{children:"Now you've set it up so the MetSci LNS can securely send data through a Zero Trust Cloudflare tunnel to Node-RED on your Raspberry Pi.  Cool, right?"}),"\n",(0,i.jsx)(n.p,{children:"Nice work!  The NSA can prolly still get in, but the rest of the screaming hordes should be kept at bay."}),"\n",(0,i.jsxs)(n.admonition,{title:"Future Integrations",type:"tip",children:[(0,i.jsx)(n.p,{children:"For each new sensor type you add:"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a new Service Token in Cloudflare named for that sensor"}),"\n",(0,i.jsx)(n.li,{children:"Configure the HTTP integration with the new token's credentials"}),"\n"]}),(0,i.jsx)(n.p,{children:"This maintains consistent security across all your sensor data routes."})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"6-local-integration-setup",children:["6. ",(0,i.jsx)(n.strong,{children:"Local Integration Setup"})]}),"\n",(0,i.jsx)(n.p,{children:"At the beginning of the tutorial we ran a script to set up all the services we'll need.  Now we'll go through and configure 'em."}),"\n",(0,i.jsx)(n.h3,{id:"a-node-red-flows",children:"A. Node-RED Flows"}),"\n",(0,i.jsx)(n.p,{children:"Node-RED is a flow-based programming tool that allows you to create data flows between nodes. In this case, our nodes represent the data flow between MetSci, the InfluxDB database on our Pi, and Grafana."}),"\n",(0,i.jsxs)(n.p,{children:["Visit Node-RED at ",(0,i.jsx)(n.code,{children:"http://<YOUR-PI-IP>:1880"})," in a browser."]}),"\n",(0,i.jsx)(n.p,{children:"If you haven't already logged in (back when we set up the services), you'll see a login screen.  Use the user & pass that was setup during the service setup.  You DID save those credentials, right?"}),"\n",(0,i.jsx)(n.p,{children:'Let me show you the whole "flow" first, it\'ll help you understand how it works.'}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Node-RED flow",src:s(1496).A+"",width:"2244",height:"460"})}),"\n",(0,i.jsx)(n.h4,{id:"1-http-in",children:"1. HTTP In"}),"\n",(0,i.jsxs)(n.p,{children:["We'll start with an ",(0,i.jsx)(n.strong,{children:"HTTP In"})," node, labeled on the image above as ",(0,i.jsx)(n.code,{children:"MetSci LDDS75 Input"}),'.  Think of it as the greeter at Wal-Mart.  "Hey, how you doing, are you decent and sober? Come on in!"']}),"\n",(0,i.jsx)(n.p,{children:"To add a node, you find it in the left menu bar, or just start typing in the name of the node at the top.  Once you see it, drag it onto the workspace."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Adding an HTTP In node",src:s(5025).A+"",width:"1186",height:"496"})}),"\n",(0,i.jsx)(n.p,{children:"Once you've dragged a node in, double click it to configure it.  For the HTTP In node:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Method: ",(0,i.jsx)(n.code,{children:"POST"})]}),"\n",(0,i.jsxs)(n.li,{children:["URL: ",(0,i.jsx)(n.code,{children:"/metsci-ldds75-data"})]}),"\n",(0,i.jsxs)(n.li,{children:["Name: ",(0,i.jsx)(n.code,{children:"MetSci LDDS75 Input"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Configuring the HTTP In node",src:s(6249).A+"",width:"2782",height:"658"})}),"\n",(0,i.jsx)(n.h4,{id:"2-https-response",children:"2. HTTPS Response"}),"\n",(0,i.jsxs)(n.p,{children:["Next we'll add in a ",(0,i.jsx)(n.strong,{children:"https response"}),' node.  This node will let the tunnel know everything is working and follow the best practices of always responding to http requests.  It\'s like when someone says "Hi" to you in the street; just say "Hi" back.']}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Adding an https response node",src:s(7343).A+"",width:"2766",height:"660"})}),"\n",(0,i.jsx)(n.p,{children:"Just make sure you name it; leave everything else blank."}),"\n",(0,i.jsx)(n.p,{children:'With two nodes in the workspace, you can start connecting \'em.  Drag a "wire" from the grey dot on the right side of the HTTP In node to the grey dot on the left side of the HTTPS Response node.'}),"\n",(0,i.jsx)(n.h4,{id:"3-json",children:"3. JSON"}),"\n",(0,i.jsxs)(n.p,{children:["Now we'll add and configure a ",(0,i.jsx)(n.strong,{children:"JSON"})," node.  JSON nodes standardize the incoming data, parse errors, and make sure the next node in the flow gets the right data."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Search for ",(0,i.jsx)(n.code,{children:"json"})," and add it to your workspace"]}),"\n",(0,i.jsxs)(n.li,{children:["Double-click to configure:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Action: ",(0,i.jsx)(n.code,{children:"Always Conver to JavaScript Object"})]}),"\n",(0,i.jsxs)(n.li,{children:["Property: ",(0,i.jsx)(n.code,{children:"msg.payload"})]}),"\n",(0,i.jsxs)(n.li,{children:["Name: ",(0,i.jsx)(n.code,{children:"Parse JSON"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Click Done to save"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This ensures our data is in the right format for processing, whether it comes from our test Inject node or the HTTP In node."}),"\n",(0,i.jsxs)(n.p,{children:["Now drag a wire from the ",(0,i.jsx)(n.strong,{children:"HTTP IN"})," node to the ",(0,i.jsx)(n.strong,{children:"Parse JSON"})," node. At this point, you'll have a wire from the ",(0,i.jsx)(n.code,{children:"HTTP In"})," node to the ",(0,i.jsx)(n.code,{children:"Parse JSON"})," node, and a wire from the ",(0,i.jsx)(n.code,{children:"Parse JSON"})," node to the ",(0,i.jsx)(n.code,{children:"HTTPS Response"})," node."]}),"\n",(0,i.jsx)(n.h4,{id:"4-switch",children:"4. Switch"}),"\n",(0,i.jsxs)(n.p,{children:["Next we'll add a ",(0,i.jsx)(n.strong,{children:"Switch"})," node to route the data to the correct sensor function."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Search for ",(0,i.jsx)(n.code,{children:"switch"})," and add it to your workspace"]}),"\n",(0,i.jsxs)(n.li,{children:["Double-click to configure:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Name: ",(0,i.jsx)(n.code,{children:"Route by Device Type"})]}),"\n",(0,i.jsxs)(n.li,{children:["Property: ",(0,i.jsx)(n.code,{children:"msg."})," ",(0,i.jsx)(n.code,{children:"payload.deviceInfo.deviceProfileName"})]}),"\n",(0,i.jsxs)(n.li,{children:["Rules:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["First rule:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Operator: ",(0,i.jsx)(n.code,{children:"contains"})]}),"\n",(0,i.jsxs)(n.li,{children:["Value: ",(0,i.jsx)(n.code,{children:"LDDS75"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.code,{children:"+"})," to add second rule:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Operator: ",(0,i.jsx)(n.code,{children:"contains"})]}),"\n",(0,i.jsxs)(n.li,{children:["Value: ",(0,i.jsx)(n.code,{children:"AM319"})," (just a demo for this tutorial)"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:'Check "otherwise" to catch unknown devices'}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Click Done to save"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This node examines the device profile name in the incoming message and routes it to the appropriate function node."}),"\n",(0,i.jsx)(n.p,{children:'If the incoming message contains "LDDS75", it goes to output 1, if it contains "AM319" (which we haven\'t set up yet), it goes to output 2, and any unknown devices go to the "otherwise" output where you can handle them (e.g., with a debug node to see what arrived).'}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Configuring the switch node",src:s(3914).A+"",width:"2762",height:"968"})}),"\n",(0,i.jsxs)(n.p,{children:["Wire the ",(0,i.jsx)(n.code,{children:"Parse JSON"})," node to the ",(0,i.jsx)(n.code,{children:"Switch"})," node."]}),"\n",(0,i.jsx)(n.h4,{id:"5-function",children:"5. Function"}),"\n",(0,i.jsxs)(n.p,{children:["Add a ",(0,i.jsx)(n.strong,{children:"Function"})," node for the LDDS75.  Function nodes are what allow us to correctly setup the data for insertion into InfluxDB.  A JSON node cleans up the data, the Switch node routes it to the correct sensor function, and a Function node formats it for InfluxDB."]}),"\n",(0,i.jsxs)(n.p,{children:["Search for a ",(0,i.jsx)(n.code,{children:"function"})," node and add it to your workspace.  The LDDS75 specs say it can measure from 280mm to 7500mm. You'll want to modify the following function to match your tank size.  I'm using a 1200mm diameter, 1850mm height tank."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Double-click to configure:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Name it ",(0,i.jsx)(n.code,{children:"LDDS75 Function"})]}),"\n",(0,i.jsxs)(n.li,{children:["Paste the following code into the ",(0,i.jsx)(n.code,{children:"Message"})," tab of the Function node:"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'try {\n    // Log receipt of message\n    node.warn("LDDS75 function processing message");\n\n    const originalPayload = msg.payload;\n    const gateway = originalPayload.rxInfo?.[0] || {};\n\n    // Get the distance value first and validate it\n    const distance = parseInt(originalPayload.object?.distance || 0);\n    \n    // Validate distance reading (LDDS75 range: 280-7500mm for flat objects)\n    if (!distance || distance < 280 || distance > 7500) {\n        node.warn("Invalid distance reading: " + distance + "mm - outside LDDS75 range (280-7500mm)");\n        return null;\n    }\n\n    // Optional: Tank-specific validation (comment out or adjust as needed)\n    const MAX_TANK_HEIGHT = 1850; // adjust this to your tank height\n    if (distance > MAX_TANK_HEIGHT) {\n        node.warn("Reading exceeds tank height: " + distance + "mm > " + MAX_TANK_HEIGHT + "mm");\n        return null;\n    }\n\n    // Create payload array with fields and tags objects\n    msg.payload = [\n        {\n            // Sensor data\n            distance: distance,\n            battery: parseFloat(originalPayload.object?.battery_voltage || 0),\n            temperature: parseFloat(originalPayload.object?.temperature || 0),\n\n            // RF metrics\n            rssi: parseInt(gateway.rssi || 0),\n            snr: parseFloat(gateway.snr || 0),\n            frequency: parseInt(originalPayload.txInfo?.frequency || 0),\n            spreading_factor: parseInt(originalPayload.dr || 0),\n            bandwidth: parseInt(originalPayload.txInfo?.modulation?.lora?.bandwidth || 0),\n\n            // Frame counter and port\n            frame_counter: parseInt(originalPayload.fCnt || 0),\n            port: parseInt(originalPayload.fPort || 0)\n        },\n        {\n            // Device info\n            device: String(originalPayload.deviceInfo?.deviceName || ""),\n            device_eui: String(originalPayload.deviceInfo?.devEui || ""),\n            device_addr: String(originalPayload.devAddr || ""),\n            device_class: String(originalPayload.deviceInfo?.deviceClassEnabled || ""),\n            device_profile: String(originalPayload.deviceInfo?.deviceProfileName || ""),\n\n            // Application info\n            application: String(originalPayload.deviceInfo?.applicationName || ""),\n            application_id: String(originalPayload.deviceInfo?.applicationId || ""),\n\n            // Gateway info\n            gateway: String(gateway.metadata?.gateway_name || ""),\n            gateway_id: String(gateway.gatewayId || ""),\n\n            // Network info\n            region: String(gateway.metadata?.region_common_name || ""),\n            network: String(gateway.metadata?.network || ""),\n            tenant: String(originalPayload.deviceInfo?.tenantName || "")\n        }\n    ];\n\n    // Set measurement name\n    msg.measurement = "ldds75_metsci";\n\n    // Add timestamp (convert to nanoseconds for InfluxDB)\n    const timestamp = new Date(originalPayload.time).getTime() * 1000000;\n    if (isNaN(timestamp)) {\n        node.warn("Invalid timestamp");\n        return null;\n    }\n    msg.payload[0].timestamp = timestamp;\n\n    // Log the attempt\n    node.warn("Writing to InfluxDB - Device: " + msg.payload[1].device + ", Distance: " + distance + " mm");\n\n    return msg;\n} catch (err) {\n    node.error("LDDS75 Processing Error: " + err.message);\n    node.error("Failed payload: " + JSON.stringify(msg.payload, null, 2));\n    node.status({ fill: "red", shape: "dot", text: "Processing Error" });\n    return null;\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Make sure you drag the wire from the correct connector on the Switch node (the top one, but you can hover over the node to see which connector is which) to the next node in the flow.  In this case, that'll be our LDDS75 Function node."}),"\n",(0,i.jsx)(n.h4,{id:"6-influxdb-out",children:"6. InfluxDB out"}),"\n",(0,i.jsxs)(n.p,{children:["Add an ",(0,i.jsx)(n.strong,{children:"InfluxDB out"})," node to the Function node to store the data in InfluxDB."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Double-click the node to configure it."}),"\n",(0,i.jsxs)(n.li,{children:["Name the node ",(0,i.jsx)(n.code,{children:"Local InfluxDB"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Click the ",(0,i.jsx)(n.code,{children:"+"}),' icon next to the "Server" field to create a new InfluxDB server configuration']}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Fill in the InfluxDB server properties:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Name: [your org name, copy this from your credentials file]\nVersion: 2.0\nURL: http://localhost:8086\nToken: [paste in your InfluxDB token from your credentials file]\nLeave other settings as is\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Add"})," to save the server configuration"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Now, in the InfluxDB Out node configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Name: Local InfluxDB\nServer: [should be the server you just set up]\nOrganization: [your org name, copy this from your credentials file]\nBucket: sensors [also in the credentials file]\nMeasurement: [leave blank]\nTime precision: `Nanoseconds` \n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Configuring the InfluxDB out node",src:s(3881).A+"",width:"2366",height:"1078"})}),"\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.code,{children:"Done"})," to save the node, then click ",(0,i.jsx)(n.code,{children:"Deploy"})," in the top-right."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Connecting the nodes",src:s(6533).A+"",width:"2580",height:"492"})}),"\n",(0,i.jsx)(n.h4,{id:"7-debug",children:"7. Debug"}),"\n",(0,i.jsx)(n.p,{children:"Now, the pro move here is to add in Debug nodes.  It's not required, but it's what I've done.  Add a Debug node to every one our regular nodes. That way we'll see what's going through the whole flow the next time we have a packet come through."}),"\n",(0,i.jsx)(n.p,{children:"For all of those:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"- Set Output to `msg.payload`\n- Name it something descriptive\n"})}),"\n",(0,i.jsx)(n.h4,{id:"8-deploy-and-test",children:"8. Deploy and test"}),"\n",(0,i.jsxs)(n.p,{children:["With your flow set up, click ",(0,i.jsx)(n.code,{children:"Deploy"})," in the top-right."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Deploying the flow",src:s(3255).A+"",width:"3200",height:"748"})}),"\n",(0,i.jsx)(n.p,{children:'You should see a green bar and the word "Deployed" at the top of the screen.'}),"\n",(0,i.jsx)(n.p,{children:"Now go back to your LDDS75 and power it back on.  Since you set it to fire on a one minute interval, you'll know quickly if everything is working or not as you'll see the data start flowing through in the debug panel on the right side."}),"\n",(0,i.jsx)(n.p,{children:"Remember, it might take a minute or two for the first join to complete and the data to start flowing."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Connecting the nodes",src:s(6333).A+"",width:"3452",height:"1200"})}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.p,{children:"This modular structure makes it easy to add more sensors later. You can see I've added an AM319 sensor to the flow above in the image.  Each sensor follows the same basic pattern:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"HTTP In (receives data)"}),"\n",(0,i.jsx)(n.li,{children:"JSON parser"}),"\n",(0,i.jsxs)(n.li,{children:["Switch (routes data to the correct sensor function)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Sensor Function (formats data for your needs)"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"InfluxDB out (stores data)"}),"\n"]})]}),"\n",(0,i.jsx)(n.h3,{id:"b-influxdb-check",children:"B. InfluxDB Check"}),"\n",(0,i.jsxs)(n.p,{children:["Let's check our InfluxDB to see if the data made it there.  Go to ",(0,i.jsx)(n.code,{children:"http://your-pi:8086"})," and sign in with the credentials from your installation."]}),"\n",(0,i.jsxs)(n.p,{children:["Go to ",(0,i.jsx)(n.code,{children:"Data Explorer"})," (the graphy icon on the left menu) and run a query for ",(0,i.jsx)(n.code,{children:"ldds75"}),' by pasting in the query below and hitting "Submit".  Hit the ',(0,i.jsx)(n.code,{children:"View Raw Data"})," button (not circled in the image).  You should see your data there."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"InfluxDB query",src:s(9676).A+"",width:"3848",height:"1566"})}),"\n",(0,i.jsxs)(n.p,{children:["Here are three script queries you can use. These use my ",(0,i.jsx)(n.code,{children:"DEVICE NAME"}),", in this case ",(0,i.jsx)(n.code,{children:"LDDS 3"}),", so ",(0,i.jsx)(n.strong,{children:"make sure you change that to your own"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"The first query gives you the basic distance to liquid surface:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-flux",children:'from(bucket: "sensors")\n  |> range(start: -24h)\n  |> filter(fn: (r) => r["_measurement"] == "ldds75_metsci")\n  |> filter(fn: (r) => r["device"] == "LDDS 3")\n  |> filter(fn: (r) => r["_field"] == "distance")\n  |> keep(columns: ["_time", "_value", "device"])\n  |> yield(name: "mm_to_surface")\n'})}),"\n",(0,i.jsx)(n.p,{children:"I built 2 more queries to see my data using my barrel size (1200mm diameter, 1850mm height)."}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"A quick note here on metric.  I'm a slowly-converting-to-metric American, so while I'll use mm for distance, I'll convert to gallons for volume.  Sorry, old habits die hard."})}),"\n",(0,i.jsxs)(n.p,{children:["First, I'll check the current water volume in gallons, again using my ",(0,i.jsx)(n.code,{children:"DEVICE NAME"}),", in this case ",(0,i.jsx)(n.code,{children:"LDDS 3"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-flux",children:'from(bucket: "sensors")\n  |> range(start: -24h)\n  |> filter(fn: (r) => r["_measurement"] == "ldds75_metsci")\n  |> filter(fn: (r) => r["device"] == "LDDS 3")\n  |> filter(fn: (r) => r["_field"] == "distance")\n  |> map(fn: (r) => ({\n       r with _value: float(v: 3.14159) * ((600.0/1000.0) ^ 2.0) * (1850.0 - float(v: r._value))/1000.0 * 264.172\n     }))\n  |> keep(columns: ["_time", "_value", "device"])\n  |> yield(name: "gallons")\n'})}),"\n",(0,i.jsx)(n.p,{children:"Here's another query you could use that would also pull the gateway name that's receiving your data,as well as the distance and RSSI fields.  You might use this to keep track of what kind of coverage you're getting from a given gateway."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-flux",children:'from(bucket: "sensors")\n  |> range(start: -24h)\n  |> filter(fn: (r) => r["_measurement"] == "ldds75_metsci")\n  |> filter(fn: (r) => r["gateway"] == "dancing-daffodil-cheetah")\n  |> filter(fn: (r) => r["region"] == "US915")\n  |> filter(fn: (r) => r["_field"] == "distance" or r["_field"] == "rssi")\n  |> keep(columns: ["_time", "_value", "_field", "device", "gateway"])\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["These are all fairly simple queries, but you may still have problems.  We're nerds, and nerd stuff usually don't work right the first time.  That's OK.  If you have problems, start by checking to make sure your queries in InfluxDB match your Device Names, Gateway, and Region.  If you just copy/paste exactly what I put, you're not going to see anything because it'll be looking for my ",(0,i.jsx)(n.code,{children:"DEVICE NAME"}),", in this case ",(0,i.jsx)(n.code,{children:"LDDS 3"}),".  By far the fastest way to debug on your own is to feed in messages from Node-RED debug and InfluxDB,  and drop screenshots into ChatGPT/Cursor/Grok etc."]})}),"\n",(0,i.jsx)(n.h3,{id:"c-grafana-dashboards",children:"C. Grafana Dashboards"}),"\n",(0,i.jsx)(n.p,{children:"Now let's head over to Grafana and set up a dashboard, woohoo!"}),"\n",(0,i.jsxs)(n.p,{children:["Go to the local Grafana at ",(0,i.jsx)(n.code,{children:"http://your-pi:3000"})," and sign in with the credentials from your installation.  You'll see something like this after you sign in:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Grafana dashboard",src:s(6585).A+"",width:"3332",height:"1204"})}),"\n",(0,i.jsx)(n.p,{children:"Now that we have data flowing into InfluxDB, let's visualize it in Grafana! First, we'll connect Grafana to our InfluxDB data source."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Connections"})," in the left-side menu"]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Add new connection"})]}),"\n",(0,i.jsxs)(n.li,{children:["Search for ",(0,i.jsx)(n.code,{children:"InfluxDB"})," and select it"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Adding a new InfluxDB connection",src:s(1842).A+"",width:"3146",height:"1026"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"Add new data source"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Configure the following settings, leaving everything else as is:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Basic Settings:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Name: ",(0,i.jsx)(n.code,{children:"Local InfluxDB"})]}),"\n",(0,i.jsx)(n.li,{children:"Default: \u2713 (checked)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Query Language:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Select: ",(0,i.jsx)(n.code,{children:"Flux"}),"\n(You'll see a note that Flux support is in beta - that's okay!)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"HTTP Settings:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["URL: ",(0,i.jsx)(n.code,{children:"http://<YOUR-PI-IP>:8086"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Auth:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Basic auth: Toggle ON"}),"\n",(0,i.jsx)(n.li,{children:"With Credentials: Toggle ON"}),"\n",(0,i.jsx)(n.li,{children:"User: [your InfluxDB username]"}),"\n",(0,i.jsx)(n.li,{children:"Password: [your InfluxDB password]"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"InfluxDB Details:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Organization: [your org name from credentials file]"}),"\n",(0,i.jsx)(n.li,{children:"Token: [paste your token from credentials file]"}),"\n",(0,i.jsxs)(n.li,{children:["Default Bucket: ",(0,i.jsx)(n.code,{children:"sensors"})]}),"\n",(0,i.jsxs)(n.li,{children:["Min time interval: ",(0,i.jsx)(n.code,{children:"10s"})]}),"\n",(0,i.jsxs)(n.li,{children:["Max series: ",(0,i.jsx)(n.code,{children:"1000"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"Save & test"}),' at the bottom\nYou should see "Data source is working" if everything is configured correctly']}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Grafana InfluxDB connection setup",src:s(6994).A+"",width:"2472",height:"1166"})}),"\n",(0,i.jsx)(n.p,{children:"Now let's create a dashboard to visualize our LDDS75 data."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Grafana add new dashboard",src:s(9004).A+"",width:"1866",height:"700"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Click the ",(0,i.jsx)(n.strong,{children:"+"})," icon up at the top right"]}),"\n",(0,i.jsxs)(n.li,{children:["Select ",(0,i.jsx)(n.strong,{children:"New Dashboard"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Add visualization"})]}),"\n",(0,i.jsxs)(n.li,{children:["Select your ",(0,i.jsx)(n.code,{children:"Local InfluxDB"})," data source"]}),"\n",(0,i.jsxs)(n.li,{children:["In the Flux Query editor, paste the following, making sure you replace ",(0,i.jsx)(n.code,{children:"LDDS 3"})," with your own device name:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-flux",children:'from(bucket: "sensors")\n  |> range(start: -4h)\n  |> filter(fn: (r) => r["_measurement"] == "ldds75_metsci")\n  |> filter(fn: (r) => r["device"] == "LDDS 3")\n  |> filter(fn: (r) => r["_field"] == "distance")\n  |> keep(columns: ["_time", "_value", "device"])\n  |> last()\n  |> yield(name: "distance")\n'})}),"\n",(0,i.jsx)(n.p,{children:"Now, over on the right, we're going to configure the visualization settings."}),"\n",(0,i.jsxs)(n.p,{children:["The type of visualization we're going to use is a ",(0,i.jsx)(n.code,{children:"Time Series"})," graph.  This is ideal for showing changes over time."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Grafana Time Series",src:s(6662).A+"",width:"2906",height:"1448"})}),"\n",(0,i.jsxs)(n.p,{children:["At the top right, select ",(0,i.jsx)(n.code,{children:"Time series"}),"."]}),"\n",(0,i.jsxs)(n.ol,{start:"6",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Panel Options"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'Title: "Water Level"'}),"\n",(0,i.jsx)(n.li,{children:'Description: "Current distance to liquid surface"'}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Value Options"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'Calculate: "Last *"'}),"\n",(0,i.jsx)(n.li,{children:'Fields: Select "Numeric Fields" only'}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Standard Options"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Unit: Distance \u2192 millimeters (mm)"}),"\n",(0,i.jsx)(n.li,{children:"Min: 0"}),"\n",(0,i.jsx)(n.li,{children:"Max: 8500 (this is the max, adjust based on your tank size)"}),"\n",(0,i.jsx)(n.li,{children:"Decimals: 0 (millimeters don't need decimals)"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Thresholds"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Add threshold at 80% of your maximum expected water level"}),"\n",(0,i.jsx)(n.li,{children:"Base color: Green"}),"\n",(0,i.jsx)(n.li,{children:"Above 80%: Red (indicates barrel is getting full)"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Save your dashboard, then leave the edit window and go ",(0,i.jsx)(n.code,{children:"Back to dashboard"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:'keep(columns: ["_time", "_value", "device"])'})," in the query is crucial - it prevents duplicate gauges by stripping unnecessary tags while maintaining the essential data for display."]})}),"\n",(0,i.jsx)(n.p,{children:"Now let's do a little admin work, then set up the sharing aspect.  Grafana makes this dead easy."}),"\n",(0,i.jsx)(n.p,{children:"First, in your Pi Terminal:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo nano /etc/grafana/grafana.ini\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You'll see the full file, modify/add the following, ",(0,i.jsx)(n.strong,{children:"replacing the domain and subdomain with your own as appropriate"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[server]\ndomain = grafana.gristleking.dev \nroot_url = https://grafana.gristleking.dev \n\n[security]\nallow_embedding = true\n\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Save & close with ",(0,i.jsx)(n.code,{children:"Ctrl+X"}),", then ",(0,i.jsx)(n.code,{children:"Y"}),", then ",(0,i.jsx)(n.code,{children:"Enter"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Now restart Grafana:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo systemctl restart grafana-server\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Back in Grafana, ",(0,i.jsx)(n.code,{children:"Save"})," your dashboard, refresh the page, then ",(0,i.jsx)(n.code,{children:"Exit Edit"})]}),"\n",(0,i.jsxs)(n.p,{children:["Click the Share button in the top right.  Go to the ",(0,i.jsx)(n.code,{children:"Public Dashboard"})," tab"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Grafana Share Dashboard",src:s(6224).A+"",width:"3128",height:"1376"})}),"\n",(0,i.jsxs)(n.p,{children:["Check all the boxes, then click ",(0,i.jsx)(n.code,{children:"Generate Public URL"}),".  It should generate a URL like ",(0,i.jsx)(n.code,{children:"https://grafana.<YOUR-DOMAIN>>.dev/d/000000002/ldds75-metsci-dashboard?orgId=1&var-device=LDDS%202"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Copy the URL and paste it into your browser, or share it with your Mom.  Now everybody can see how much water is in your tank.  Bam, you're public!"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"d-fun-with-monitoring--triggers",children:"D. Fun with Monitoring & Triggers"}),"\n",(0,i.jsx)(n.p,{children:"We're now finished with the bulk of this tutorial.  You've got a dashboard, you've got data flowing into InfluxDB, and you've got a way to share it with the world.  From here, you can add more sensors, build more complex dashboards, or string together new Node-RED flows to trigger alerts or other actions.  Following are a few examples of what you could do next."}),"\n",(0,i.jsx)(n.h4,{id:"1-indoor-environment-monitoring",children:"1. Indoor Environment Monitoring"}),"\n",(0,i.jsx)(n.p,{children:"Liquid level sensing is simple, but generally not that exciting, so..."}),"\n",(0,i.jsx)(n.p,{children:"Using the steps above, I've added in a Milesight AM319, including an Applicaton and Policy in Cloudflare and a second dashboard.  This is what it looks like with some live data:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Grafana AM319 Dashboard",src:s(6740).A+"",width:"2528",height:"1538"})}),"\n",(0,i.jsx)(n.p,{children:"Just so you could see some real change,I closed up all the windows & doors in my office and did burpees until the CO2 went up.  You can also see where we dropped a couple of packets.  The AM319 fires a huge packet every minute, so it's easy to see where the packets are dropped."}),"\n",(0,i.jsxs)(n.admonition,{title:"Download My Node-RED Flow",type:"tip",children:[(0,i.jsx)(n.p,{children:"Want to skip the manual setup? You can download the complete LDDS75 flow here and import it directly into Node-RED."}),(0,i.jsx)("div",{className:"centered-button-container",children:(0,i.jsx)("a",{href:"/flows/MetSci-LDDS75-flow.json",className:"download-button",download:!0,children:"Download  LDDS75 Flow"})}),(0,i.jsx)(n.p,{children:"After downloading:"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Configure your InfluxDB credentials"}),"\n",(0,i.jsx)(n.li,{children:"Update any device-specific information"}),"\n",(0,i.jsx)(n.li,{children:"Deploy the flow after importing"}),"\n"]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"2-home-assistant-integration",children:"2. Home Assistant Integration"}),"\n",(0,i.jsxs)(n.p,{children:["If you're using ",(0,i.jsx)(n.a,{href:"https://www.home-assistant.io/",children:"Home Assistant"})," you can use Node-RED on the Pi to pipe in data from the dashboard you just set up to Home Assistant."]}),"\n",(0,i.jsx)(n.p,{children:"Installing and configuring HA is well beyond the scope of this tutorial, but for those of you who already have it running and want to pipe in data from your shiny new MetSci setup, here's how you can do it:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Install the Home Assistant nodes in Node-RED on your MetSci Pi:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/.node-red\nnpm install node-red-contrib-home-assistant-websocket\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In Node-RED, add and configure the ",(0,i.jsx)(n.code,{children:"home-assistant"})," config node:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Protocol: ",(0,i.jsx)(n.code,{children:"http"})," or ",(0,i.jsx)(n.code,{children:"https"})," (depending on your HA setup)"]}),"\n",(0,i.jsxs)(n.li,{children:["Base URL: ",(0,i.jsx)(n.code,{children:"http://YOUR_HA_IP:8123"})," (or your external URL)"]}),"\n",(0,i.jsx)(n.li,{children:"Access Token: Create a Long-Lived Access Token in HA\n(HA Profile \u2192 Long-Lived Access Tokens \u2192 Create Token)"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Add a ",(0,i.jsx)(n.code,{children:"call-service"})," node after your LDDS75 Function node:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'Domain: sensor\nService: set_state\nEntity ID: sensor.water_level\nData: {\n  state: msg.payload[0].distance,\n  attributes: {\n    unit_of_measurement: "mm",\n    friendly_name: "Water Level",\n    device_class: "distance",\n    battery_level: msg.payload[0].battery\n  }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Restart Home Assistant to apply changes"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.admonition,{title:"Security Considerations",type:"warning",children:[(0,i.jsx)(n.p,{children:"When connecting services across devices:"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Use strong, unique passwords and tokens"}),"\n",(0,i.jsx)(n.li,{children:"Consider setting up a VPN if accessing over the internet"}),"\n",(0,i.jsx)(n.li,{children:"Use SSL/TLS when possible"}),"\n",(0,i.jsx)(n.li,{children:"Limit firewall rules to specific IPs"}),"\n",(0,i.jsx)(n.li,{children:"Monitor logs for unauthorized access attempts"}),"\n"]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"Example Lovelace Card"})}),"\nAdd this to your Lovelace dashboard in Home Assistant:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"type: vertical-stack\ncards:\n  - type: gauge\n    name: Water Level\n    entity: sensor.water_level\n    min: 0\n    max: 2500\n    severity:\n      green: 0\n      yellow: 800\n      red: 100\n  - type: history-graph\n    title: Water Level History\n    entities:\n      - entity: sensor.water_level\n        name: Level\n"})}),"\n",(0,i.jsx)(n.h4,{id:"3-class-c-integration",children:"3. Class C Integration"}),"\n",(0,i.jsxs)(n.p,{children:["I've talked about how to use Class C in the ",(0,i.jsx)(n.a,{href:"/docs/tutorial-extras/class_C_kuando_busylight",children:"MetSci Class C via API tutorial"}),".  You could use that, or you can use Node-RED to pipe data from the LDDS75 to your Class C device, in my case, a Kuando Busylight."]}),"\n",(0,i.jsx)(n.p,{children:"Since you've already set up Node-RED, I'll just share the flow I built for mine."}),"\n",(0,i.jsx)("div",{className:"centered-button-container",children:(0,i.jsx)("a",{href:"/flows/MetSci-Busylight-Trigger-flow.json",className:"download-button",download:!0,children:"Download Busylight Trigger Flow"})}),"\n",(0,i.jsx)(n.p,{children:"It'll look like this:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Node-RED Busylight Trigger",src:s(1353).A+"",width:"2762",height:"632"})}),"\n",(0,i.jsx)(n.p,{children:"Setting that up will check the LDDS75 distance measurements in the InfluxDB every 15 minutes, then flash your Busylight red 5 times on a 1 second interval every 15 minutes when the tank is full (distance of 120mm or less) until you turn the Node-RED alert off or the tank is no longer full."}),"\n",(0,i.jsx)(n.p,{children:"Let your imagination run wild!  You could also use this to trigger other actions, like sending an email, triggering a Home Assistant automation, or even triggering a Class C device to send a message:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:'Airstrikes required on unknown vehicle parked in "MY" parking spot'})}),"\n",(0,i.jsx)(n.p,{children:"Just kidding, airstrikes triggered by a LoRaWAN device are for war, not parking violations.  But...we're American, so maybe we can make an execption. \ud83d\ude09"}),"\n",(0,i.jsx)(n.h2,{id:"7-system-maintenance--troubleshooting",children:"7. System Maintenance & Troubleshooting"}),"\n",(0,i.jsx)(n.h3,{id:"a-credentials-management",children:"A. Credentials Management"}),"\n",(0,i.jsx)(n.p,{children:"Your credentials are stored in several locations:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Node-RED: ",(0,i.jsx)(n.code,{children:"~/.node-red/settings.js"})]}),"\n",(0,i.jsxs)(n.li,{children:["InfluxDB: ",(0,i.jsx)(n.code,{children:"/var/lib/influxdb/influxd.bolt"})," (and ",(0,i.jsx)(n.code,{children:"/var/lib/influxdb/engine/"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["Grafana: ",(0,i.jsx)(n.code,{children:"/etc/grafana/grafana.ini"})]}),"\n",(0,i.jsxs)(n.li,{children:["Installation credentials: Generated in ",(0,i.jsx)(n.code,{children:"~/metsci-credentials.txt"})]}),"\n"]}),"\n",(0,i.jsxs)(n.admonition,{type:"warning",children:[(0,i.jsxs)(n.p,{children:["After setting up your services, securely store the contents of ",(0,i.jsx)(n.code,{children:"~/metsci-credentials.txt"})," somewhere safe, then delete it from your Pi:"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rm ~/metsci-credentials.txt\n"})})]}),"\n",(0,i.jsx)(n.h3,{id:"b-backing-up-configurations",children:"B. Backing Up Configurations"}),"\n",(0,i.jsx)(n.p,{children:"Create a backup script for your configurations:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\nBACKUP_DIR="/mnt/ssd/backups/$(date +%Y%m%d)"\nmkdir -p $BACKUP_DIR\n\n# Backup Node-RED flows and settings\ncp -r ~/.node-red/* $BACKUP_DIR/node-red/\n\n# Backup service configs\nsudo cp -r /var/lib/influxdb $BACKUP_DIR/influxdb/\nsudo cp /etc/grafana/grafana.ini $BACKUP_DIR/\n\n# Set permissions\nsudo chown -R $USER:$USER $BACKUP_DIR\n'})}),"\n",(0,i.jsx)(n.h3,{id:"c-system-updates",children:"C. System Updates"}),"\n",(0,i.jsx)(n.p,{children:"Regular maintenance tasks:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Update system packages\nsudo apt update && sudo apt upgrade -y\n\n# Restart services after updates\nsudo systemctl restart nodered influxdb grafana-server\n"})}),"\n",(0,i.jsx)(n.h3,{id:"d-troubleshooting-guide",children:"D. Troubleshooting Guide"}),"\n",(0,i.jsx)(n.h4,{id:"1-service-not-starting",children:"1. Service Not Starting"}),"\n",(0,i.jsx)(n.p,{children:"Check service status:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo systemctl status [service-name]  # nodered, influxdb, or grafana-server\n"})}),"\n",(0,i.jsx)(n.p,{children:"View logs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo journalctl -u [service-name] -n 50 --no-pager\n"})}),"\n",(0,i.jsx)(n.h4,{id:"2-lost-connection-to-pi",children:"2. Lost Connection to Pi"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check if Pi is powered on"}),"\n",(0,i.jsx)(n.li,{children:"Verify network connection"}),"\n",(0,i.jsx)(n.li,{children:"Try direct connection via ethernet"}),"\n",(0,i.jsx)(n.li,{children:"Check Cloudflare tunnel status:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo systemctl status cloudflared\n"})}),"\n",(0,i.jsx)(n.h4,{id:"3-data-not-flowing",children:"3. Data Not Flowing"}),"\n",(0,i.jsx)(n.p,{children:"Check each step:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"MetSci LNS \u2192 View device events in console"}),"\n",(0,i.jsx)(n.li,{children:"Cloudflare \u2192 Check tunnel logs"}),"\n",(0,i.jsx)(n.li,{children:"Node-RED \u2192 Check debug tab"}),"\n",(0,i.jsxs)(n.li,{children:["InfluxDB \u2192 Test token and query recent data:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Test token\ncurl -v "http://localhost:8086/api/v2/write?org=YOUR_ORG&bucket=sensors" \\\n  -H "Authorization: Token YOUR_TOKEN" \\\n  -d "test,host=test value=1"\n'})}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Grafana \u2192 Check data source connection"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"4-disk-space-issues",children:"4. Disk Space Issues"}),"\n",(0,i.jsx)(n.p,{children:"Monitor disk usage:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"df -h\n```Check service logs taking up space:\n```bash\nsudo du -h /var/log | sort -rh | head -n 10\n"})}),"\n",(0,i.jsxs)(n.admonition,{title:"Recovery Steps",type:"tip",children:[(0,i.jsx)(n.p,{children:"If something goes wrong:"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check the relevant service status"}),"\n",(0,i.jsx)(n.li,{children:"Review the logs"}),"\n",(0,i.jsx)(n.li,{children:"Restore from backup if needed"}),"\n",(0,i.jsx)(n.li,{children:"If nothing else works, you can always reinstall the affected service"}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"8-la-ultima",children:"8. La Ultima"}),"\n",(0,i.jsxs)(n.p,{children:["Last step?  ",(0,i.jsx)(n.a,{href:"https://grafana.meteoscientific.com/public-dashboards/e6bd9074e3ad4fad935bbcacb510059b",children:"Here's the dashbboard"})," I built for MeteoScientific, combining the rain barrel data with weather station data."]}),"\n",(0,i.jsxs)(n.p,{children:["I'd love to see what you do!  Please tag us on X ",(0,i.jsx)(n.a,{href:"https://x.com/meteoscientific",children:"MeteoScientific"})," and ",(0,i.jsx)(n.a,{href:"https://x.com/thegristleking",children:"Gristleking"})," we'd love to see what you've done!"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Nik throwing the horns on a fully installed LDDS75 sensor",src:s(2174).A+"",width:"4032",height:"3024"})}),"\n",(0,i.jsx)(n.p,{children:"This tutorial was made possible by a generous grant from the Helium Foundation's IOTWG; huge thanks to them for the support."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},4791:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/device-metrics-dont-worry-b63704ef1341dec161fac87a2a55324f.png"},4819:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/link-metrics-ldds75-9f7ddb610ac150fcad0de8d7c4309e5d.png"},4918:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-set-service-token-rule-ldds75-c027de1942dc8af258cb6fea1bab5f9d.png"},5025:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/node-red-drag-in-node-6b6a51214ab511842be94385a4d65c6f.png"},6006:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-both-public-hostnames-added-4e8fdc2bd337d4ed4008a974dd2d90e6.png"},6041:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-dns-route-note-45d8b4a0b18fb45c04e27b0e81f8eb6f.png"},6043:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-global-application-policy-ee36147de346060af81da1e6cc2d8c73.png"},6140:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/zero-trust-applications-d775031f17c13f18c144e99eb95dae61.png"},6224:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/grafana-share-dashboard-00feca51837db213b24a3d1e697e646b.png"},6249:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/node-red-configure-http-in-ldds75-514bb23c3d1b94156e1b5ff40c8166ac.png"},6333:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/node-red-first-flow-f13245cfad52cead06df3288de8c3b1b.png"},6533:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/node-red-ldds-basic-flow-no-debug-76ced46c22f0ff2b3c561f3d83da2e8d.png"},6585:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/grafana-home-78da1abadacb5c1b0a1c23ee771a2335.png"},6662:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/grafana-initial-setup-55e5f0fce100f2f2529b071b9220bcc3.png"},6740:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/grafana-am319-burpees-f5901472e051262896e6c35183535ba9.png"},6743:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-add-route-to-tunnel-88b75db640d7ce5c99922d6349dc2af4.png"},6765:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/set-up-zero-trust-37fbb6652c242d4e3098946e716064c0.png"},6994:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/grafana-influxdb-settings-4e8cb2a20280d8a93e613fd2afd55050.png"},7007:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-configure-application-details-2205212f399c3e8d62ab1e32830888ed.png"},7290:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/zero-trust-networks-tunnels-6db95f93c240dd64af0e04575a868175.png"},7343:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/node-red-http-response-node-fe0586efb2db104f706957c6edafd73e.png"},7704:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-service-tokens-created-bf4f92e015b081f15c449e0a21508b7d.png"},7958:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/metsci-http-integration-74dc275b3d2774bcd374e47587ef5c07.png"},8290:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-grafana-public-access-domains-cc5f63e37dbf0e58cfdb47ed5018db4c.png"},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>a});var i=s(6540);const t={},o=i.createContext(t);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(o.Provider,{value:n},e.children)}},8519:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/choose-tunnel-name-444c2da19b82188ab8953e4ae07ba5d9.png"},9004:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/grafana-build-new-dashboard-9b5e8e14d2afca56f4308cc8e71dff02.png"},9482:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-select-add-public-hostname-for-new-route-0a5055bacf4489d1b6e2118123c70d1c.png"},9676:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/influxdb-data-explorer-130676423c521e55a7d42ae30e19ce6b.png"},9859:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudflare-dashboard-0ec7331195391edf233eb605aaa55b25.png"}}]);