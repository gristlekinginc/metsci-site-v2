<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorial-extras/metsci-demo-dash" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">MetSci Demo Dashboard - MeteoScientific</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://www.meteoscientific.com/docs/tutorial-extras/metsci-demo-dash"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:type" content="website"><meta data-rh="true" property="og:image" content="https://meteoscientific.com/img/metsci-pro-social-card_1200x630.png"><meta data-rh="true" property="og:image:secure_url" content="https://meteoscientific.com/img/metsci-pro-social-card_1200x630.png"><meta data-rh="true" property="og:image:width" content="1200"><meta data-rh="true" property="og:image:height" content="630"><meta data-rh="true" property="og:image:type" content="image/png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:title" content="MeteoScientific - The Business of LoRaWAN"><meta data-rh="true" name="twitter:description"><meta data-rh="true" name="twitter:image" content="https://meteoscientific.com/img/metsci-pro-social-card-x_800x418.png"><meta data-rh="true" property="og:site_name" content="MeteoScientific"><meta data-rh="true" name="keywords" content="LoRaWAN, business IoT, massive IoT, LPWAN sensors"><meta data-rh="true" name="author" content="MeteoScientific"><meta data-rh="true" property="og:image:mobile" content="https://meteoscientific.com/img/metsci-pro-social-card-sms_300x200.png"><meta data-rh="true" property="og:image:mobile:width" content="300"><meta data-rh="true" property="og:image:mobile:height" content="200"><meta data-rh="true" property="og:image:type" content="image/png"><meta data-rh="true" property="og:image:alt" content="MeteoScientific - The Business of LoRaWAN"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="MetSci Demo Dashboard - MeteoScientific"><meta data-rh="true" name="description" content="Ok nerds, let&#x27;s do something rad with Helium and build a dashboard for a sensor."><meta data-rh="true" property="og:description" content="Ok nerds, let&#x27;s do something rad with Helium and build a dashboard for a sensor."><link data-rh="true" rel="icon" href="/img/metsci_pro_favicon.svg"><link data-rh="true" rel="canonical" href="https://www.meteoscientific.com/docs/tutorial-extras/metsci-demo-dash"><link data-rh="true" rel="alternate" href="https://www.meteoscientific.com/docs/tutorial-extras/metsci-demo-dash" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.meteoscientific.com/docs/tutorial-extras/metsci-demo-dash" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="MeteoScientific RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="MeteoScientific Atom Feed">



<link rel="preload" href="/img/metsci_logo.svg" as="image" type="image/svg+xml">
<link rel="stylesheet" href="/css/custom.css">
<script src="https://www.googletagmanager.com/gtag/js?id=G-VNEKDSD64E" async></script>
<script src="/js/ga.js" async></script><link rel="stylesheet" href="/assets/css/styles.1d6a5c8f.css">
<script src="/assets/js/runtime~main.08569b51.js" defer="defer"></script>
<script src="/assets/js/main.1ec3ab93.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/metsci_logo.svg" alt="MetSci Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/metsci_logo.svg" alt="MetSci Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">MeteoScientific</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/tutorial-basics/LoRaWAN-Big-Picture">Tutorials</a><a class="navbar__item navbar__link" href="/podcast">Podcast</a><a class="navbar__item navbar__link" href="/pricing">Pricing</a><a href="https://console.meteoscientific.com/front/login" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Console</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/gristlekinginc/metsci-site-v2" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tutorial-basics/LoRaWAN-Big-Picture">Tutorial Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/tutorial-extras/documentation">Tutorial Extras</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-extras/documentation">Finding Docs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-extras/class_C_kuando_busylight">Class C via API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-extras/Google_Sheets">Integrating Google Sheets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tutorial-extras/metsci-demo-dash">MetSci Demo Dashboard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-extras/spreading-factor-chirps">Spreading Factor &amp; Chirps</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/codecs/overview">Codec Library</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tutorial Extras</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">MetSci Demo Dashboard</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Build a Custom Dashboard</h1>
<p>Ok nerds, let&#x27;s do something rad with <a href="https://www.helium.com/" target="_blank" rel="noopener noreferrer">Helium</a> and build a dashboard for a sensor.</p>
<p><strong>You don&#x27;t actually have to be a nerd to do this.</strong> As long as you can get the hardware listed below, follow directions, and copy/paste, you&#x27;re going to end up with a working dashboard.</p>
<p>When you&#x27;re done, this&#x27;ll be something you can share with your friends to let them know when the rain barrel is full (or if you&#x27;re Joey&#x27;s friends, when the sauna is hot)!</p>
<p>I know, I know, you could use a ready-made service like <a href="https://datacake.de" target="_blank" rel="noopener noreferrer">Datacake</a> for public dashbaords, but...we&#x27;re nerds, and wherever possible we build our own things.</p>
<p>Relax, it won&#x27;t be super hard.  We&#x27;ll use a few scripts to make installing things secure and easy, so they just &quot;work&quot;.</p>
<p>My goal here is to enable a non-technical person to build your own &quot;no-subscription&quot; public or private dashboards for about $200, most of which you&#x27;ll spend on equipment you&#x27;ll use in every other IoT project you do.</p>
<p>IoT stuff has been super fun for me to explore, and I&#x27;m pumped to share it with you.  This is pretty much a love letter to you from me about IoT.</p>
<p>Enjoy!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-after-it">Get After It<a href="#get-after-it" class="hash-link" aria-label="Direct link to Get After It" title="Direct link to Get After It">​</a></h3>
<p>Make sure you have the following on hand:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-hardware">A. Hardware<a href="#a-hardware" class="hash-link" aria-label="Direct link to A. Hardware" title="Direct link to A. Hardware">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-core-development-hardware-150-use-this-for-your-next-50-projects">1. Core Development Hardware, ~$150 (use this for your next 50 projects)<a href="#1-core-development-hardware-150-use-this-for-your-next-50-projects" class="hash-link" aria-label="Direct link to 1. Core Development Hardware, ~$150 (use this for your next 50 projects)" title="Direct link to 1. Core Development Hardware, ~$150 (use this for your next 50 projects)">​</a></h4>
<ul>
<li><a href="https://amzn.to/3DAVCnO" target="_blank" rel="noopener noreferrer">Rasbperry Pi 4 with 4 or 8 GB RAM</a>, about $60.</li>
<li><a href="https://amzn.to/40ha8K5" target="_blank" rel="noopener noreferrer">SD Card for Pi</a>, about $10</li>
<li>External SSD for the Pi, about $30.  IoT data sets can get pretty big and you&#x27;ll want plenty of space beyond the SD card on the Pi.  SD cards can also wear out if you write to &#x27;em a bunch. Something like <a href="https://amzn.to/3PbhbNY" target="_blank" rel="noopener noreferrer">this</a> is fine.</li>
<li>USB-TTL adapter (the thing that allows you to communicate directly over-the-wire with the sensor)<!-- -->
<ul>
<li><a href="https://buspirate.com/" target="_blank" rel="noopener noreferrer">BusPirate</a>  This is what the mighty Teague uses, and I recommend it. I used the v5 for this, but the v6 is already out!  $40-80</li>
<li>Cheapie <a href="https://www.amazon.com/dp/B07VNVVXW6?ref=ppx_pop_mob_ap_share" target="_blank" rel="noopener noreferrer">Amazon Kit</a> (thanks to GreyHat for the rec) $14</li>
<li><a href="https://www.sparkfun.com/products/24078" target="_blank" rel="noopener noreferrer">Segger J-Link EDU Mini</a> - $60 on Sparkfun</li>
</ul>
</li>
<li>2 x <a href="https://amzn.to/4aoqS5N" target="_blank" rel="noopener noreferrer">USB A to USB C cables</a> (connecting the Pi to the SD card and the Bus Pirate to your computer)</li>
<li><a href="https://amzn.to/4h0Jn2w" target="_blank" rel="noopener noreferrer">Dupont wires</a> for connecting the Bus Pirate to the sensor - $7</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>If you want a fancy case for your Pi (NOT needed), this is what I use: <a href="https://amzn.to/3E9OEpM" target="_blank" rel="noopener noreferrer">FLIRC case</a> for Raspberry Pi 4B, about $16</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-sensor-60-80">2. Sensor, $60-80<a href="#2-sensor-60-80" class="hash-link" aria-label="Direct link to 2. Sensor, $60-80" title="Direct link to 2. Sensor, $60-80">​</a></h4>
<ul>
<li>Dragino LDDS 75 sensor.  You can buy one at <a href="https://www.robotshop.com/products/dragino-ldds75-lorawan-distance-detection-sensor-915-mhz" target="_blank" rel="noopener noreferrer">RobotShop</a> for $60-80.</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><ol>
<li>The Pi, SD, SSD, and USB cables are Amazon affiliate links.  If 300 of you use those I&#x27;ll probably be able to pay half my annual $12 domain name bill with the commissions.</li>
<li>I&#x27;m doing this whole thing on a Mac.  If you&#x27;re on Windows, there&#x27;ll be a couple commands that are slightly different, usually stuff like using <code>CMD</code> instead of <code>CTRL</code>.  I&#x27;ll try to call them out as we go.</li>
</ol></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-not-hardware">B. Not-Hardware<a href="#b-not-hardware" class="hash-link" aria-label="Direct link to B. Not-Hardware" title="Direct link to B. Not-Hardware">​</a></h3>
<ul>
<li>Custom domain.  For this tutorial I&#x27;ll be using mine, <code>gristleking.dev</code>.  If you don&#x27;t already have a domain, I&#x27;d <strong>strongly</strong> recommend buying one at <a href="https://cloudflare.com" target="_blank" rel="noopener noreferrer">Cloudflare</a>.  They&#x27;re about $12/year and buying it there makes everything else a little bit easier.</li>
<li>If you have a domain already, you&#x27;ll need to set up your domain&#x27;s name servers to point to Cloudflare.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="c-notes-on-what-you-need">C. Notes on what you &quot;Need&quot;<a href="#c-notes-on-what-you-need" class="hash-link" aria-label="Direct link to C. Notes on what you &quot;Need&quot;" title="Direct link to C. Notes on what you &quot;Need&quot;">​</a></h3>
<p>You don&#x27;t actually NEED a USB-TTL adapter, but it&#x27;s generally good practice to have one hanging around the work bench if you&#x27;re any kind of aspiring nerd.  You could use downlinks instead of the adapter to make changes to your sensor, but in practice I&#x27;ve found that to add both complication and time (especially if you have to wait for the next uplink &amp; you get your downlink command wrong...ask me how I know)</p>
<p>You <em>could</em> do this without a custom domain by hosting in the cloud and managing tunnels with Cloudflare, but then you&#x27;re on the hook for cloud hosting, which is probably $6/month at the cheapest.  A domain is something like $70/year for an expensive <code>.ai</code> one and $12/year for a cheap one. Trust me, just buy a domain.</p>
<p>Having your own domain makes part of this workflow way simpler, plus it&#x27;s just cool to have your own domain.  Ask Larry at Google or Steve at Apple.  Having a custom domain is cool.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-set-up-overview">1. Set Up Overview<a href="#1-set-up-overview" class="hash-link" aria-label="Direct link to 1. Set Up Overview" title="Direct link to 1. Set Up Overview">​</a></h2>
<ol>
<li>
<p><strong>Set Up Your Rasbperry Pi:</strong> Basic setup and security</p>
</li>
<li>
<p><strong>Install Services:</strong> Node-RED, InfluxDB, Grafana, integrate external SSD.</p>
</li>
<li>
<p><strong>Cloudflare:</strong> Set up tunnels, tokens, applications, and policies.</p>
</li>
<li>
<p><strong>Sensor:</strong> Get the sensor sending data through MetSci</p>
</li>
<li>
<p><strong>Local Integration Testing:</strong> Node-RED flows, integrate InfluxDB, create Grafana dashboards.</p>
</li>
<li>
<p><strong>System Maintenance &amp; Troubleshooting:</strong> Keep it rolling smooth, yo.</p>
</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-setting-up-your-rasbperry-pi">2. <strong>Setting Up Your Rasbperry Pi</strong><a href="#2-setting-up-your-rasbperry-pi" class="hash-link" aria-label="Direct link to 2-setting-up-your-rasbperry-pi" title="Direct link to 2-setting-up-your-rasbperry-pi">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-basic-setup">A. Basic Setup<a href="#a-basic-setup" class="hash-link" aria-label="Direct link to A. Basic Setup" title="Direct link to A. Basic Setup">​</a></h3>
<p>Rather than re-writing (and constantly updating) this part, I&#x27;m going to suggest you <a href="https://www.raspberrypi.com/software/" target="_blank" rel="noopener noreferrer">follow the official docs</a> for the first part of this and load <strong>Raspberry Pi OS Lite (64-bit)</strong>.  If you&#x27;ve never done it before, that&#x27;s ok.</p>
<p>The basic flow is to write (or &quot;flash&quot;) the OS onto an SD card using your computer, then plug the SD card into your Pi.  After that you&#x27;ll find the Pi on your local network and you can SSH in.  All of those things have lots of tutorials on the internet already.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Starting with a fresh OS install is recommended to avoid conflicts with existing packages.</p></div></div>
<p>Once you&#x27;ve set up your Pi, connect it to your local network (Ethernet/LAN cable strongly preferred over WiFi).  SSH in using Terminal, then update/upgrade with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt update &amp;&amp; sudo apt dist-upgrade -y &amp;&amp; sudo apt autoremove -y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-securing-your-pi">B. Securing Your Pi<a href="#b-securing-your-pi" class="hash-link" aria-label="Direct link to B. Securing Your Pi" title="Direct link to B. Securing Your Pi">​</a></h3>
<p>Your Pi can be made a bit more secure with a few commands.  We&#x27;re going to wrap them all up into one.  This is going to get the latest security patches, make sure everything is up to date, then set some basic firewall rules.</p>
<p>There&#x27;s nothing ultra fancy in here, just generally good Pi housekeeping.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -sSL meteoscientific.com/scripts/secure-pi.sh -o secure.sh &amp;&amp; chmod +x secure.sh &amp;&amp; sudo ./secure.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Once you&#x27;ve run it to the end, it&#x27;ll ask you if you want to reboot.  Just type in <code>y</code> and hit <code>Enter</code>.</p>
<p>If you want to make your Pi significantly more protected, set up keys instead of passwords.  Doing that is beyond the scope of this tutorial and is well covered on the interwebz in general.  I&#x27;d <a href="https://pimylifeup.com/raspberry-pi-ssh-keys/" target="_blank" rel="noopener noreferrer">start here</a> if you need help (or have ChatGPT walk you through it).</p>
<p>Let&#x27;s move on to installing the services we need.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-install-services-node-red-influxdb-grafana">3. <strong>Install Services (Node-RED, InfluxDB, Grafana)</strong><a href="#3-install-services-node-red-influxdb-grafana" class="hash-link" aria-label="Direct link to 3-install-services-node-red-influxdb-grafana" title="Direct link to 3-install-services-node-red-influxdb-grafana">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-service-install-script">A. Service Install Script<a href="#a-service-install-script" class="hash-link" aria-label="Direct link to A. Service Install Script" title="Direct link to A. Service Install Script">​</a></h3>
<p>Copy &amp; paste the following command into your Pi&#x27;s Terminal:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -sSL meteoscientific.com/scripts/install-dashboard-v3.sh -o dashboard.sh &amp;&amp; chmod +x dashboard.sh &amp;&amp; sudo ./dashboard.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>During the installation you&#x27;ll get a few questions and warnings.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>If you have a 4GB RAM Pi, you&#x27;ll see a warning message about performance.  This is just to clarify that if you want to run a shitload of sensors frequently you&#x27;ll probablly be better with an 8GB RAM Pi.  For most people, <strong>4GB is fine</strong> and <strong>8GB is overkill</strong>.</p></div></div>
<p>The script will set up your &quot;Organization&quot; name (used in the database).  The default is <code>MeteoScientific</code>, feel free to change that if you&#x27;d like.  This is mostly a structural thing, so just use something descriptive.</p>
<p>It&#x27;ll also set up a bunch of random sci-fi usernames for the various services.</p>
<p>You can accept all the defaults and be fine, or feel free to change them if you want different user names.  Don&#x27;t get too twisted up with it; again, the defaults are fine.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Make sure you copy down your credentials when you see &#x27;em at the end.  They&#x27;ll be saved to a file in your home directory just in case, but you really should copy them down and then delete that file before you move on.</p></div></div>
<p>After installation, visit your shiny new setups:</p>
<ul>
<li>Node-RED: <a href="http://your-pi:1880" target="_blank" rel="noopener noreferrer">http://your-pi:1880</a></li>
<li>InfluxDB: <a href="http://your-pi:8086" target="_blank" rel="noopener noreferrer">http://your-pi:8086</a></li>
<li>Grafana: <a href="http://your-pi:3000" target="_blank" rel="noopener noreferrer">http://your-pi:3000</a></li>
</ul>
<p><strong>DON&#x27;T skip copying down your credentials</strong> (instructions are at the end of the script) and then deleting that file.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /home/&lt;YOUR-USER&gt;/metsci-credentials.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>That will print out your credentials, which you&#x27;ll need to use later.  Save those somewhere safe, then delete the file with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rm -rf /home/&lt;YOUR-USER&gt;/metsci-credentials.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-integrate-external-ssd">B. Integrate External SSD<a href="#b-integrate-external-ssd" class="hash-link" aria-label="Direct link to B. Integrate External SSD" title="Direct link to B. Integrate External SSD">​</a></h3>
<p>Now that your services are installed, let&#x27;s make sure InfluxDB is using the SSD.</p>
<p>Using a USB cable, connect your external SSD to one of the USB 3.0 ports on your Pi. Here I&#x27;m using PoE to power and connect the Pi, and the SSD is just laid on top.  The case is a 3D print so I can mount the Pi on the wall in my server (and clothes) closet.</p>
<p><img decoding="async" loading="lazy" alt="Raspberry Pi mounted on closet wall with SSD" src="/assets/images/raspberry-pi-with-ssd-closet-680aa2f792c8b8639ba91d0af25b1c71.png" width="2724" height="2062" class="img_ev3q"></p>
<p>Then, in your Terminal:</p>
<ol>
<li>Verify the SSD is detected:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lsblk</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<!-- -->You should see something like this:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">core@myrmytron:~ $ lsblk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sda           8:0    0 111.8G  0 disk </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> └─sda1        8:1    0 111.8G  0 part </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> mmcblk0     179:0    0 116.2G  0 disk </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ├─mmcblk0p1 179:1    0   512M  0 part /boot/firmware</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> └─mmcblk0p2 179:2    0 115.7G  0 part /</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>See how my sda lists <code>sda1</code>?  We&#x27;ll use that <code>sda1</code> in this next command; yours may be named differently.</p>
<ol start="2">
<li>Mount the SSD to a permanent location, e.g., <code>/mnt/ssd</code>:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo mkdir -p /mnt/ssd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mount /dev/sda1 /mnt/ssd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>Set the ownership for your user.  In my case, that&#x27;s <code>core</code>.  You may have named yours different.  Replace <strong>core<!-- -->:core</strong> with your user name.<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown -R core:core /mnt/ssd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>Open up <code>/etc/fstab</code> so we can set this up for persistence.<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo nano /etc/fstab</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<!-- -->In your <code>/etc/fstab</code>, add a line like this, replacing <code>sda1</code> with the correct partition identifier from <code>lsblk</code> above.<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/dev/sda1 /mnt/ssd ext4 defaults 0 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<!-- -->Save and exit with <code>CTRL-X</code>, then <code>y</code>, then <code>Enter</code>.</li>
</ol>
<p>Nice work!</p>
<p>Now make sure you did that right. Verify SSD with the following commands:</p>
<p>After mounting:</p>
<ol>
<li>
<p>Check mount: <code>lsblk</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># You should see your SSD mounted at /mnt/ssd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sda           8:0    0 111.8G  0 disk </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─sda1        8:1    0 111.8G  0 part /mnt/ssd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Verify permissions:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /mnt/ssd`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see something like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">total 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwx------ 2 core core 16384 Nov 30 14:41 lost+found</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>lost+found</code> directory is normal for a fresh ext4 filesystem.</p>
<ol start="3">
<li>Test write access:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   touch /mnt/ssd/test.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Verify it was created</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /mnt/ssd/test.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see something like:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 core core 0 Jan 4 22:45 test.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Clean up</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rm /mnt/ssd/test.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If any of these commands fail with &quot;permission denied&quot;, your ownership isn&#x27;t set correctly.</p>
<p>Nice work, you&#x27;ve set up the major components of your dashboard.  Now let&#x27;s set up the Cloudflare tunnel to securely move data between your Pi and the internet.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-cloudflare-tunnels-applications-and-tokens">4. <strong>Cloudflare:</strong> Tunnels, Applications, and Tokens<a href="#4-cloudflare-tunnels-applications-and-tokens" class="hash-link" aria-label="Direct link to 4-cloudflare-tunnels-applications-and-tokens" title="Direct link to 4-cloudflare-tunnels-applications-and-tokens">​</a></h2>
<p>Cloudflare provides a secure connection called a &quot;tunnel&quot; between your Pi and the internet.  Within a tunnel will be different public hostnames for different services, like <code>node-red.gristleking.dev</code> for Node-RED and <code>grafana.gristleking.dev</code> for Grafana.  We&#x27;ll use those to connect our Pi to the internet in a secure way.</p>
<p>Think of a tunnel like a big PVC pipe that connects your Pi to the internet.  Within that pipe are lots of individual pipes that carry separate types of information to different places.  Each individualpipe is a public hostname in the tunnel, and within those pipes you&#x27;ll split it out even further into different Applications that manage the data from different types of sensors.</p>
<p>Cloudflare changes and updates all the time, so the screenshots and instructions below may be slightly different than what you see in Cloudflare.</p>
<p>Before we set up the tunnel, we&#x27;re going to build the access control we need to keep our Pi secure.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-set-up-zero-trust">A. Set Up Zero Trust<a href="#a-set-up-zero-trust" class="hash-link" aria-label="Direct link to A. Set Up Zero Trust" title="Direct link to A. Set Up Zero Trust">​</a></h3>
<p>To start this off, login to <a href="https://www.cloudflare.com/" target="_blank" rel="noopener noreferrer">Cloudflare</a>. I&#x27;m assuming you&#x27;ve already set up your domain with Cloudflare, so when you log in you&#x27;ll see something like this:</p>
<p><img decoding="async" loading="lazy" alt="Cloudflare Dashboard" src="/assets/images/cloudflare-dashboard-0ec7331195391edf233eb605aaa55b25.png" width="3188" height="1358" class="img_ev3q"></p>
<p>You&#x27;ll need to set up your Zero Trust account in Cloudflare (relax, it&#x27;s free).</p>
<p>If you haven&#x27;t set up Zero Trust yet, you may not see &quot;Zero Trust&quot; in your menu.  If that&#x27;s the case, navigate to your domain name, look for <code>Access</code> in the left menu, then hit the <code>Launch Zero Trust</code> blue button on the right, then click it and set up Zero Trust.</p>
<p><img decoding="async" loading="lazy" alt="Cloudflare Zero Trust" src="/assets/images/set-up-zero-trust-37fbb6652c242d4e3098946e716064c0.png" width="2564" height="1724" class="img_ev3q"></p>
<p>Once you have it, you&#x27;ll see it in your <strong>Main</strong> (not your domain) Cloudflare menu, like this.</p>
<p><img decoding="async" loading="lazy" alt="Cloudflare Zero Trust" src="/assets/images/go-to-zero-trust-1d2e00c4df76d081e8c0e82c4186002c.png" width="3114" height="1574" class="img_ev3q"></p>
<p>With Zero Trust on and ready to go, let&#x27;s set up all the access control we need before connecting our Pi to the internet.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-zero-trust-token--application-setup">B. Zero Trust Token &amp; Application Setup<a href="#b-zero-trust-token--application-setup" class="hash-link" aria-label="Direct link to B. Zero Trust Token &amp; Application Setup" title="Direct link to B. Zero Trust Token &amp; Application Setup">​</a></h3>
<p>With our public hostnames set up we&#x27;ll need to protect them so that not every jackass and their brother can drop into our Node-RED or Grafana instances.  We&#x27;ll do that with Cloudflare&#x27;s Zero Trust.</p>
<p>For each public hostname, we&#x27;ll create Applications and Tokens to manage access for them.  In general, we don&#x27;t want the public to have any access to our Node-RED instance, but we do want to share our Grafana dashboard with the public.</p>
<p>Let&#x27;s start with the Node-RED Application and Token, focusing on what we&#x27;ll need for the LDDS75.</p>
<p>We&#x27;ll need three things in order to manage access in Cloudflare Zero Trust:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. A Service Token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. A Zero Trust Application</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. A Zero Trust Policy Rule</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The use of the word &quot;Application&quot; can be a bit confusing here, as we have both Cloudflare Applications and MetSci Applications.</p><p>Remember, a <code>MetSci Application</code> is a group of sensors that share the same data structure.  If you were monitoring 30 rainwater tanks with 30 LDDS75 sensors, all of the sensors would be in one MetSci Application, which would map to one <code>Cloudflare Application</code>.</p><p>A <code>Cloudflare Application</code> is used to manage a Zero Trust setup.  In our case, we&#x27;ll use <code>Service Tokens</code> as a gatekeeper (&quot;No token no entry&quot;) as well as a routing requirement, where the LDDS75 token will help route all the LDDS75 data to the Node-RED instance.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-create-service-tokens">1. Create Service Tokens<a href="#1-create-service-tokens" class="hash-link" aria-label="Direct link to 1. Create Service Tokens" title="Direct link to 1. Create Service Tokens">​</a></h4>
<p>In Cloudflare, back in Zero Trust, go to <code>Access--&gt;Service Auth</code> and click <code>Create Service Token</code>.</p>
<p>We&#x27;ll start with a Service Token for Node-RED.  Name your token something descriptive (I&#x27;ll use <code>ldds75</code>) and set the duration to <code>Non-expiring</code>.</p>
<p><img decoding="async" loading="lazy" alt="Add a Service Token in Zero Trust" src="/assets/images/cloudflare-configure-service-auth-token-ldds75-161082be8e832d27b725b0a9be455cbc.png" width="2320" height="614" class="img_ev3q"></p>
<p>That will give you an <code>Access ID</code> and an <code>Access secret</code>.  Save <strong>both the headers and the access codes</strong> in a secure place.  We&#x27;ll need them when we set up the HTTP integration in MetSci.  What you save should look like this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CF-Access-Client-Id: 5xxxxxxxxxxxxxxxxxxxxxxxx3.access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CF-Access-Client-Secret: ffxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Hit the <code>Save</code> button at the bottom right.</p>
<p>Using that same process of <code>Access--&gt;Service Auth--&gt;Create Service Token</code>, create another Service Token for Grafana.  I&#x27;ll use <code>grafana-admin</code>.  When you&#x27;re finished, you&#x27;ll have two Service Tokens, like this:</p>
<p><img decoding="async" loading="lazy" alt="Two Service Tokens" src="/assets/images/cloudflare-service-tokens-created-bf4f92e015b081f15c449e0a21508b7d.png" width="2640" height="812" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="c-zero-trust-applications">C. Zero Trust Applications<a href="#c-zero-trust-applications" class="hash-link" aria-label="Direct link to C. Zero Trust Applications" title="Direct link to C. Zero Trust Applications">​</a></h3>
<p>We&#x27;re going to set up 4 Applications.  Two for NOD-RED, and two for Grafana.  They&#x27;ll do slightly different things, but the process of setting them up is the same.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="node-red-applications">Node-RED Applications<a href="#node-red-applications" class="hash-link" aria-label="Direct link to Node-RED Applications" title="Direct link to Node-RED Applications">​</a></h4>
<p>Go to <code>Access--&gt;Applications</code> and add a new Cloudflare Application.</p>
<p><img decoding="async" loading="lazy" alt="Add a Zero Trust Application" src="/assets/images/zero-trust-applications-d775031f17c13f18c144e99eb95dae61.png" width="2716" height="1580" class="img_ev3q"></p>
<p>Select <code>Self Hosted</code></p>
<p>In Node-RED, we don&#x27;t want any public access, so we&#x27;ll set up a global gatekeeper and then a specific application to allow our MetSci LDDS75 data to pass through.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="node-red-application---global">Node-RED Application - Global<a href="#node-red-application---global" class="hash-link" aria-label="Direct link to Node-RED Application - Global" title="Direct link to Node-RED Application - Global">​</a></h4>
<p>Let&#x27;s start with the global Node-RED application.</p>
<p>Set the Application name to <code>Node-RED</code> and set the <code>Session Duration</code> to <code>24 hours</code>.  Then set the subdomain to <code>node-red</code>, the <code>domain</code> to <code>&lt;YOUR-DOMAIN&gt;.com</code>, and the <code>path</code> to <code>*</code>.</p>
<p><img decoding="async" loading="lazy" alt="Add a global application" src="/assets/images/cloudflare-global-application-b7a68ae2a09c07c8b6065d46c1c4de44.png" width="2318" height="880" class="img_ev3q"></p>
<p>Scroll down to the bottom and click <code>Next</code> to proceed to the <code>Policies</code> section.  Here we&#x27;ll set up a Policy rule that requires anything using this Application to have a valid token.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="node-red-policy-rule---global">Node-RED Policy Rule - Global<a href="#node-red-policy-rule---global" class="hash-link" aria-label="Direct link to Node-RED Policy Rule - Global" title="Direct link to Node-RED Policy Rule - Global">​</a></h4>
<p>Set the policy name to <code>Node-RED</code> and set the Action to <code>Service Auth</code>, leave the duration as is.</p>
<p>Scroll down a bit until you see <code>Configure rules</code>.  On the Selector choose <code>Any Access Service Token</code>.  It will automatically fill in a value of <code>Any non expired Service Token will be matched</code>.</p>
<p><img decoding="async" loading="lazy" alt="Add a policy rule" src="/assets/images/cloudflare-global-application-policy-ee36147de346060af81da1e6cc2d8c73.png" width="2936" height="1838" class="img_ev3q"></p>
<p>Hit <code>Next</code> and scroll down to the bottom of the next page (past <code>CORS</code>, <code>Cookies</code>, and <code>Additional Settings</code>), then click <code>Add Application</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="node-red-application---ldds75">Node-RED Application - LDDS75<a href="#node-red-application---ldds75" class="hash-link" aria-label="Direct link to Node-RED Application - LDDS75" title="Direct link to Node-RED Application - LDDS75">​</a></h4>
<p>Now you&#x27;ll create the LDDS75 Application, which will only apply to our LDDS75 data.  Hit the <code>Add Application</code>, then <code>Self Hosted</code> (just like last time), then give it a descriptive name like <code>ldds75</code>.</p>
<p>Leave the session duration at <code>24 hours</code> then enter the subdomain, domain, and path it&#x27;ll use.</p>
<p>In this case, use <code>node-red</code> . <code>gristleking.dev</code> / <code>metsci-ldds75-data</code>.</p>
<p>We&#x27;ll use the <code>metsci-ldds75-data</code> path later when we set up our Node-RED flow.</p>
<p><img decoding="async" loading="lazy" alt="Configure Zero Trust Appication" src="/assets/images/cloudflare-configure-application-details-2205212f399c3e8d62ab1e32830888ed.png" width="2750" height="882" class="img_ev3q"></p>
<p>Scroll down past <code>Application Appearances</code> and <code>Tags</code> etc to the bottom.</p>
<p>Click <code>Next</code> to proceed to the <code>Policies</code> section.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="node-red-policy-rule---ldds75">Node-RED Policy Rule - LDDS75<a href="#node-red-policy-rule---ldds75" class="hash-link" aria-label="Direct link to Node-RED Policy Rule - LDDS75" title="Direct link to Node-RED Policy Rule - LDDS75">​</a></h4>
<p>We&#x27;ll use the same <code>Service Auth</code> policy as the global application, but this time we&#x27;ll restrict it to the <code>ldds75</code> token we&#x27;ve set up.</p>
<p>Set the policy name to <code>ldds75</code> and set the Action to <code>Allow</code>, leave the duration as is.</p>
<p><img decoding="async" loading="lazy" alt="Set up your policy" src="/assets/images/cloudflare-policy-configure-a6d616a596b08ecb33b227eb59f17f93.png" width="2722" height="1080" class="img_ev3q"></p>
<p>Scroll down to <code>Configure rules</code>.  On the Selector choose <code>Service Token</code>, then select the Service Token you just created.</p>
<p><img decoding="async" loading="lazy" alt="Configure Policy for your LDDS75 Zero Trust Application" src="/assets/images/cloudflare-set-service-token-rule-ldds75-c027de1942dc8af258cb6fea1bab5f9d.png" width="2574" height="664" class="img_ev3q"></p>
<p>Click <code>Next</code>, then scroll through the next page, past CORS settings, Cookies settings, and Additional settings. Click <code>Add Application</code> at the bottom right and you&#x27;re done with the Node-RED Applications.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="grafana-applications">Grafana Applications<a href="#grafana-applications" class="hash-link" aria-label="Direct link to Grafana Applications" title="Direct link to Grafana Applications">​</a></h4>
<p>Ok, now we&#x27;ll set up the Grafana Applications.  Unlike Node-RED where we&#x27;re blocking ALL access to the public, this time we want to block access to the Grafana admin side but allow public access to specific Grafana dashboards.</p>
<p>Since you&#x27;ve already set up two Applications, I&#x27;ll go a little faster.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="grafana-application--policy---access-control">Grafana Application &amp; Policy - Access Control<a href="#grafana-application--policy---access-control" class="hash-link" aria-label="Direct link to Grafana Application &amp; Policy - Access Control" title="Direct link to Grafana Application &amp; Policy - Access Control">​</a></h4>
<p><code>Zero Trust --&gt; Access --&gt; Applications --&gt; Add Application --&gt; Self Hosted</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Application name: `Grafana Access Control`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Session Duration: `24 hours`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subdomain: `grafana`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Domain: `&lt;YOUR-DOMAIN&gt;.com`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Path: `*`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Scroll down to the bottom and click <code>Next</code> to proceed to the <code>Policies</code> section.</p>
<p>Add a policy with the following:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Policy name: Token Auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Action: Service Auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Session Duration: Same as application session timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Scroll down and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Configure rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Include: Any Access Service Token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Value: Any non expired Service Token will be matched</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="Grafana Access Control Application" src="/assets/images/cloudflare-grafana-access-control-0c0be2d1134ccd4e40b4be528a979671.png" width="1200" height="600" class="img_ev3q"></p>
<p>Scroll down to the bottom of the next page and click <code>Add Application</code>.  You don&#x27;t need to set up a specific Service Auth token for this, you just need to require that any service token is needed to access Grafana except for viewing public dashboards.  We&#x27;ll set that Application and Policy up next.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="grafana-application--policy---public-access">Grafana Application &amp; Policy - Public Access<a href="#grafana-application--policy---public-access" class="hash-link" aria-label="Direct link to Grafana Application &amp; Policy - Public Access" title="Direct link to Grafana Application &amp; Policy - Public Access">​</a></h4>
<p><code>Zero Trust --&gt; Access --&gt; Applications --&gt; Add Application --&gt; Self Hosted</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Application name: `Grafana Public Access`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Session Duration: `24 hours`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subdomain: `grafana`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Domain: `&lt;YOUR-DOMAIN&gt;.com`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Path: `public*`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then add two more domains, with two different paths:</p>
<p><img decoding="async" loading="lazy" alt="Add a Grafana Public Access Application" src="/assets/images/cloudflare-grafana-public-access-domains-cc5f63e37dbf0e58cfdb47ed5018db4c.png" width="2010" height="952" class="img_ev3q"></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- Subdomain: `grafana`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Domain: `&lt;YOUR-DOMAIN&gt;.com`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Path: `public-dashboards*`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>and</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- Subdomain: `grafana`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Domain: `&lt;YOUR-DOMAIN&gt;.com`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Path: `api/public*`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Scroll down to the bottom and click <code>Next</code> to proceed to the <code>Policies</code> section.</p>
<p>Add a policy with the following:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Policy name: Bypass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Action: Bypass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Session Duration: Same as application session timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Scroll down and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Configure rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Include: Everyone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Value: Everyone (will fill in automatically)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Super, now you&#x27;ve set up all your Cloudflare Applications and Policies.  The &quot;gates&quot; are setup, so now we can set up and connect the Cloudflare Tunnel to securely move data between your Pi and the internet.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="d-prepare-your-pi-for-cloudflare">D. Prepare Your Pi for Cloudflare<a href="#d-prepare-your-pi-for-cloudflare" class="hash-link" aria-label="Direct link to D. Prepare Your Pi for Cloudflare" title="Direct link to D. Prepare Your Pi for Cloudflare">​</a></h3>
<p>In the Pi terminal, install Cloudflare Tunnel.  It&#x27;s good practice when you&#x27;re adding anything to your Pi to kick things off with a system update:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt update &amp;&amp; sudo apt upgrade -y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now that the Pi is cleaned &amp; ready, download the Cloudflare binary to the Pi.  I&#x27;m running a Pi 4B with 64-bit ARM architecture (use <code>uname -m</code> to check yours if you&#x27;re unsure), so here&#x27;s the command I&#x27;m using:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wget https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-arm64 -O cloudflared</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>That may take a few minutes depending on your connection speed.</p>
<p>When it&#x27;s done, let&#x27;s do a few nerdy things (making the binary executable, moving it to a system path, then verifying the installation).</p>
<p>Make it executable:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod +x cloudflared</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Move it to a system directory:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo mv cloudflared /usr/local/bin/cloudflared</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Verify the installation:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cloudflared --version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>That should get you here on your Pi:</p>
<p><img decoding="async" loading="lazy" alt="Cloudflare tunnel installed and ready to set up" src="/assets/images/set-up-cloudflare-tunnel-36ae00c1ee990dc76ef0ef5a5bab33d4.png" width="1740" height="270" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="e-create-a-tunnel-in-cloudflare-zero-trust">E. Create a Tunnel In Cloudflare Zero Trust<a href="#e-create-a-tunnel-in-cloudflare-zero-trust" class="hash-link" aria-label="Direct link to E. Create a Tunnel In Cloudflare Zero Trust" title="Direct link to E. Create a Tunnel In Cloudflare Zero Trust">​</a></h3>
<p>With Cloudflare&#x27;s Zero Trust on and our Pi set up, we&#x27;re going to set up the actual tunnel.</p>
<p>Back in your Cloudflare account, in Zero Trust, go to <code>Networks --&gt; Tunnels --&gt; Add a tunnel</code>.</p>
<p><img decoding="async" loading="lazy" alt="Zero Trust Network Tunnels" src="/assets/images/zero-trust-networks-tunnels-6db95f93c240dd64af0e04575a868175.png" width="2546" height="1170" class="img_ev3q"></p>
<p>On the next page (not shown here), select <code>Cloudflared</code>, <strong>NOT</strong> <code>WARP Connector</code>, then choose a tunnel name.  I&#x27;ll use <code>metsci-demo</code> for mine.</p>
<p><img decoding="async" loading="lazy" alt="Name your Cloudflare tunnel" src="/assets/images/choose-tunnel-name-444c2da19b82188ab8953e4ae07ba5d9.png" width="3310" height="1382" class="img_ev3q"></p>
<p>Save the tunnel and you&#x27;ll be taken to the <code>Configure</code> page.  Look for the <code>Install and Run Connector</code> section and copy the command on the right.</p>
<p><img decoding="async" loading="lazy" alt="Install and run connector" src="/assets/images/install-and-run-connector-f960bf726a7e1d1ef871a2f72073aed1.png" width="2670" height="1336" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="f-add-the-tunnel-to-your-raspberry-pi">F. Add The Tunnel To Your Raspberry Pi<a href="#f-add-the-tunnel-to-your-raspberry-pi" class="hash-link" aria-label="Direct link to F. Add The Tunnel To Your Raspberry Pi" title="Direct link to F. Add The Tunnel To Your Raspberry Pi">​</a></h3>
<p>Back on your Pi, run the command they gave us:</p>
<p><code>sudo cloudflared service install super-duper-alpha-numeric-string</code></p>
<p>You should see a success message, like this.</p>
<p><img decoding="async" loading="lazy" alt="Tunnel successfully installed" src="/assets/images/tunnel-success-872fe72f263426a840648f0e1e9bed09.png" width="3184" height="1902" class="img_ev3q"></p>
<p>Hit <code>Next</code> at the bottom right of your Cloudflare Configure tunnel screen.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="g-setting-up-public-hostnames">G. Setting Up Public Hostnames<a href="#g-setting-up-public-hostnames" class="hash-link" aria-label="Direct link to G. Setting Up Public Hostnames" title="Direct link to G. Setting Up Public Hostnames">​</a></h3>
<p>With our tunnel set up, now we&#x27;ll create our Public Hostnames (subdomains), starting with Node-RED.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-node-red-subdomain">1. Node-RED Subdomain<a href="#1-node-red-subdomain" class="hash-link" aria-label="Direct link to 1. Node-RED Subdomain" title="Direct link to 1. Node-RED Subdomain">​</a></h4>
<p>Add <code>node-red</code> in the Subdomain field, then choose your domain. I&#x27;m using <code>gristleking.dev</code> for this tutorial.  Throughout the tutorial, wherever you see <code>gristleking.dev</code>, replace it with your own domain.</p>
<p>For Type choose <code>HTTP</code>, then set the URL to <code>localhost:1880</code>, which is the port Node-RED runs on.</p>
<p>Now hit the blue <code>Save tunnel</code> button at the bottom right.</p>
<p><img decoding="async" loading="lazy" alt="Configure your initial public hostname" src="/assets/images/cloudflare-initial-tunnel-setup-route-setup-f766d8145e231d5cb8be5012a20207dc.png" width="2590" height="1464" class="img_ev3q"></p>
<p>You&#x27;ll be taken back to the Tunnels page.  Click on the three stacked dots on the right side of the row for your tunnel, then click <code>Configure</code>.</p>
<p><img decoding="async" loading="lazy" alt="Adding a new public hostname to a Cloudflare Tunnel" src="/assets/images/cloudflare-add-route-to-tunnel-88b75db640d7ce5c99922d6349dc2af4.png" width="3718" height="782" class="img_ev3q"></p>
<p>Now we&#x27;ll set up the Grafana public hostname.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-grafana-subdomain">2. Grafana Subdomain<a href="#2-grafana-subdomain" class="hash-link" aria-label="Direct link to 2. Grafana Subdomain" title="Direct link to 2. Grafana Subdomain">​</a></h4>
<p>Select <code>Public Hostname</code> and click <code>Add a public hostname</code>.</p>
<p><img decoding="async" loading="lazy" alt="Add a new public hostname" src="/assets/images/cloudflare-select-add-public-hostname-for-new-route-0a5055bacf4489d1b6e2118123c70d1c.png" width="2592" height="1126" class="img_ev3q"></p>
<p>Set it up the same way you did for Ned-RED, just subbing in <code>grafana</code> and the correct port as follows:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-Subdomain: grafana</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-Domain: &lt;YOUR-DOMAIN&gt;.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-Type: HTTP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-URL: localhost:3000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It should look like this:</p>
<p><img decoding="async" loading="lazy" alt="Add the hostname and post for Grafana" src="/assets/images/cloudflare-add-public-hostname-grafana-f1cd92d86ff97895df745b2daa274bc4.png" width="2134" height="328" class="img_ev3q"></p>
<p>Click <code>Save hostname</code>.</p>
<p>You can now see both your public hostnames for your tunnel.  Cool, right?</p>
<p><img decoding="async" loading="lazy" alt="Confirm both your public hostnames" src="/assets/images/cloudflare-both-public-hostnames-added-4e8fdc2bd337d4ed4008a974dd2d90e6.png" width="2642" height="840" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="h-document-your-public-hostnames">H. Document Your Public Hostnames<a href="#h-document-your-public-hostnames" class="hash-link" aria-label="Direct link to H. Document Your Public Hostnames" title="Direct link to H. Document Your Public Hostnames">​</a></h3>
<p>Head back to the Cloudflare main menu and choose your domain, then <code>DNS</code>, then look for the subdomain you just set up.  I usually add a note to mine, something like <code>this is for Node-RED for the MetSci Demo Dash project</code>, just so future me has a clue as to what&#x27;s going on.</p>
<p><img decoding="async" loading="lazy" alt="Add notes to your DNS records" src="/assets/images/cloudflare-dns-route-note-45d8b4a0b18fb45c04e27b0e81f8eb6f.png" width="3276" height="1890" class="img_ev3q"></p>
<p>Now you&#x27;ve set it up so that you can share a dashboard via your Cloudflare tunnel, but the rest of your Grafana instance is still protected.  Big thanks to <strong>Chaika</strong> over on the Cloudflare Discord for walking me through the Grafana dashboard setup!</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-setting-up-your-ldds-75-sensor">5. <strong>Setting Up Your LDDS 75 Sensor</strong><a href="#5-setting-up-your-ldds-75-sensor" class="hash-link" aria-label="Direct link to 5-setting-up-your-ldds-75-sensor" title="Direct link to 5-setting-up-your-ldds-75-sensor">​</a></h2>
<p>Whether this is your first device ever or your 100th, now is a good time to think about how you&#x27;re going to structure your data.  I&#x27;ve written a <a href="/docs/tutorial-basics/good-housekeeping-for-LoRaWAN-sensor-fleets">separate tutorial just on structuring data</a>. If you&#x27;ve never thought about this before, it&#x27;s a good idea to read through that.  You can also just YOLO and follow along, trusting that my data structure is good enough for you.</p>
<p>I&#x27;m not going to tell you what to do, but I will tell you that if you&#x27;re going to be doing anything with your data, you&#x27;re going to want to think about it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-provision-that-sucker">A. Provision That Sucker!<a href="#a-provision-that-sucker" class="hash-link" aria-label="Direct link to A. Provision That Sucker!" title="Direct link to A. Provision That Sucker!">​</a></h3>
<p>Use the <a href="/docs/tutorial-basics/adding-a-device">Add A Device</a> tutorial on this site to walk you through it.  A working codec for the device is in MetSci already. When you&#x27;re done, it should look like this:</p>
<p><img decoding="async" loading="lazy" alt="LDDS 75 reporting in the MetSci Chirpstack" src="/assets/images/LDDS75-working-on-MetSci-e8affb042ea528d31249b1b3f608dc09.png" width="2582" height="876" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-check-link-metrics">B. Check Link Metrics<a href="#b-check-link-metrics" class="hash-link" aria-label="Direct link to B. Check Link Metrics" title="Direct link to B. Check Link Metrics">​</a></h3>
<p>Ok, assuming you&#x27;ve got your data structure set up, after a while (for me this is about 3 weeks) your Link Metrics for the device will be pretty boring flat lines, like this:</p>
<p><img decoding="async" loading="lazy" alt="LDDS 75 Link Metrics" src="/assets/images/link-metrics-ldds75-9f7ddb610ac150fcad0de8d7c4309e5d.png" width="4672" height="1574" class="img_ev3q"></p>
<p>Quick note:  You <em>can&#x27;t</em> see the <strong>Device Metrics</strong> properly in Chirpstack, which is what we&#x27;re using for an LNS, as both the Battery Voltage and the Distance will be off the chart, which is 0 - 1.0, and unless you have the optional extra temp sensor you won&#x27;t see that either.  Don&#x27;t worry about seeing anything here; that&#x27;s why we&#x27;re setting up a dashboard.  🔧</p>
<p><img decoding="async" loading="lazy" alt="LDDS 75 Link Metrics" src="/assets/images/device-metrics-dont-worry-b63704ef1341dec161fac87a2a55324f.png" width="4674" height="1596" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="c-configure-for-fast-firing">C. Configure For Fast Firing<a href="#c-configure-for-fast-firing" class="hash-link" aria-label="Direct link to C. Configure For Fast Firing" title="Direct link to C. Configure For Fast Firing">​</a></h3>
<p>We&#x27;re going to need some data coming through the tunnel in a bit, so let&#x27;s set up the LDDS75 to fire every minute for now, then we&#x27;ll pull the power until we&#x27;re ready to test.</p>
<p>Use <a href="/docs/tutorial-basics/configure-a-device">this guide</a> to set up the LDDS75 to fire every minute.  You &quot;could&quot; theoretically do all this with downlinks, but A) I&#x27;m not covering that here and B) I want you to have the ability to wire into a sensor and tell it what to do.</p>
<p>However you do it...</p>
<p>Once you&#x27;ve got it set up and seen a few packets come through, pull the power on your LDDS75 using the yellow jumper; we&#x27;ll use it again in a bit.</p>
<p><img decoding="async" loading="lazy" alt="LDDS 75 jumper" src="/assets/images/ldds-75-jumper-power-off-303383f4668f118a24c3078f770006a0.jpeg" width="4032" height="3024" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="d-set-up-the-http-integration-in-metsci">D. Set Up The HTTP Integration In MetSci<a href="#d-set-up-the-http-integration-in-metsci" class="hash-link" aria-label="Direct link to D. Set Up The HTTP Integration In MetSci" title="Direct link to D. Set Up The HTTP Integration In MetSci">​</a></h3>
<p>Head back over to the <a href="https://console.meteoscientific.com/front/login" target="_blank" rel="noopener noreferrer">MeteoScientific Console</a> and in <code>Applications</code>--&gt;<code>LDDS 75</code> (or whatever you called it), look for the <code>Integrations</code> tab.</p>
<p><img decoding="async" loading="lazy" alt="MetSci LDDS 75 Integrations" src="/assets/images/metsci-applications-integrations-tab-33c3cbc5a92fef65662ac1dc2d00f406.png" width="2562" height="1668" class="img_ev3q"></p>
<p>Find &#x27;HTTP Integrations&quot; and hit the <code>+</code>.</p>
<p>Leave the payload encoding set to JSON.</p>
<p>Change the event endpoint to <code>https://node-red.&lt;YOUR-DOMAIN&gt;/metsci-ldds75-data/</code> then add two headers:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CF-Access-Client-ID &lt;your-access-id&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CF-Access-Client-Secret &lt;your-access-secret&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Use the <code>Access ID</code> and <code>Access Secret</code> from the Service Token you set up for the LDDS75 in Cloudflare.</p>
<p><img decoding="async" loading="lazy" alt="Set up your http integration in MetSci Chirpstack" src="/assets/images/metsci-http-integration-74dc275b3d2774bcd374e47587ef5c07.png" width="3266" height="1256" class="img_ev3q"></p>
<p>Now you&#x27;ve set it up so the MetSci LNS can securely send data through a Zero Trust Cloudflare tunnel to Node-RED on your Raspberry Pi.  Cool, right?</p>
<p>Nice work!  The NSA can prolly still get in, but the rest of the screaming hordes should be kept at bay.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Future Integrations</div><div class="admonitionContent_BuS1"><p>For each new sensor type you add:</p><ol>
<li>Create a new Service Token in Cloudflare named for that sensor</li>
<li>Configure the HTTP integration with the new token&#x27;s credentials</li>
</ol><p>This maintains consistent security across all your sensor data routes.</p></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-local-integration-setup">6. <strong>Local Integration Setup</strong><a href="#6-local-integration-setup" class="hash-link" aria-label="Direct link to 6-local-integration-setup" title="Direct link to 6-local-integration-setup">​</a></h2>
<p>At the beginning of the tutorial we ran a script to set up all the services we&#x27;ll need.  Now we&#x27;ll go through and configure &#x27;em.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-node-red-flows">A. Node-RED Flows<a href="#a-node-red-flows" class="hash-link" aria-label="Direct link to A. Node-RED Flows" title="Direct link to A. Node-RED Flows">​</a></h3>
<p>Node-RED is a flow-based programming tool that allows you to create data flows between nodes. In this case, our nodes represent the data flow between MetSci, the InfluxDB database on our Pi, and Grafana.</p>
<p>Visit Node-RED at <code>http://&lt;YOUR-PI-IP&gt;:1880</code> in a browser.</p>
<p>If you haven&#x27;t already logged in (back when we set up the services), you&#x27;ll see a login screen.  Use the user &amp; pass that was setup during the service setup.  You DID save those credentials, right?</p>
<p>Let me show you the whole &quot;flow&quot; first, it&#x27;ll help you understand how it works.</p>
<p><img decoding="async" loading="lazy" alt="Node-RED flow" src="/assets/images/node-red-full-flow-0d230113fa5c9dd3cd5dabacf12daa48.png" width="2244" height="460" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-http-in">1. HTTP In<a href="#1-http-in" class="hash-link" aria-label="Direct link to 1. HTTP In" title="Direct link to 1. HTTP In">​</a></h4>
<p>We&#x27;ll start with an <strong>HTTP In</strong> node, labeled on the image above as <code>MetSci LDDS75 Input</code>.  Think of it as the greeter at Wal-Mart.  &quot;Hey, how you doing, are you decent and sober? Come on in!&quot;</p>
<p>To add a node, you find it in the left menu bar, or just start typing in the name of the node at the top.  Once you see it, drag it onto the workspace.</p>
<p><img decoding="async" loading="lazy" alt="Adding an HTTP In node" src="/assets/images/node-red-drag-in-node-6b6a51214ab511842be94385a4d65c6f.png" width="1186" height="496" class="img_ev3q"></p>
<p>Once you&#x27;ve dragged a node in, double click it to configure it.  For the HTTP In node:</p>
<ul>
<li>Method: <code>POST</code></li>
<li>URL: <code>/metsci-ldds75-data</code></li>
<li>Name: <code>MetSci LDDS75 Input</code></li>
</ul>
<p><img decoding="async" loading="lazy" alt="Configuring the HTTP In node" src="/assets/images/node-red-configure-http-in-ldds75-514bb23c3d1b94156e1b5ff40c8166ac.png" width="2782" height="658" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-https-response">2. HTTPS Response<a href="#2-https-response" class="hash-link" aria-label="Direct link to 2. HTTPS Response" title="Direct link to 2. HTTPS Response">​</a></h4>
<p>Next we&#x27;ll add in a <strong>https response</strong> node.  This node will let the tunnel know everything is working and follow the best practices of always responding to http requests.  It&#x27;s like when someone says &quot;Hi&quot; to you in the street; just say &quot;Hi&quot; back.</p>
<p><img decoding="async" loading="lazy" alt="Adding an https response node" src="/assets/images/node-red-http-response-node-fe0586efb2db104f706957c6edafd73e.png" width="2766" height="660" class="img_ev3q"></p>
<p>Just make sure you name it; leave everything else blank.</p>
<p>With two nodes in the workspace, you can start connecting &#x27;em.  Drag a &quot;wire&quot; from the grey dot on the right side of the HTTP In node to the grey dot on the left side of the HTTPS Response node.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-json">3. JSON<a href="#3-json" class="hash-link" aria-label="Direct link to 3. JSON" title="Direct link to 3. JSON">​</a></h4>
<p>Now we&#x27;ll add and configure a <strong>JSON</strong> node.  JSON nodes standardize the incoming data, parse errors, and make sure the next node in the flow gets the right data.</p>
<ul>
<li>Search for <code>json</code> and add it to your workspace</li>
<li>Double-click to configure:<!-- -->
<ul>
<li>Action: <code>Always Conver to JavaScript Object</code></li>
<li>Property: <code>msg.payload</code></li>
<li>Name: <code>Parse JSON</code></li>
</ul>
</li>
<li>Click Done to save</li>
</ul>
<p>This ensures our data is in the right format for processing, whether it comes from our test Inject node or the HTTP In node.</p>
<p>Now drag a wire from the <strong>HTTP IN</strong> node to the <strong>Parse JSON</strong> node. At this point, you&#x27;ll have a wire from the <code>HTTP In</code> node to the <code>Parse JSON</code> node, and a wire from the <code>Parse JSON</code> node to the <code>HTTPS Response</code> node.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-switch">4. Switch<a href="#4-switch" class="hash-link" aria-label="Direct link to 4. Switch" title="Direct link to 4. Switch">​</a></h4>
<p>Next we&#x27;ll add a <strong>Switch</strong> node to route the data to the correct sensor function.</p>
<ul>
<li>Search for <code>switch</code> and add it to your workspace</li>
<li>Double-click to configure:<!-- -->
<ul>
<li>Name: <code>Route by Device Type</code></li>
<li>Property: <code>msg.</code> <code>payload.deviceInfo.deviceProfileName</code></li>
<li>Rules:<!-- -->
<ol>
<li>First rule:<!-- -->
<ul>
<li>Operator: <code>contains</code></li>
<li>Value: <code>LDDS75</code></li>
</ul>
</li>
<li>Click <code>+</code> to add second rule:<!-- -->
<ul>
<li>Operator: <code>contains</code></li>
<li>Value: <code>AM319</code> (just a demo for this tutorial)</li>
</ul>
</li>
</ol>
</li>
<li>Check &quot;otherwise&quot; to catch unknown devices</li>
</ul>
</li>
<li>Click Done to save</li>
</ul>
<p>This node examines the device profile name in the incoming message and routes it to the appropriate function node.</p>
<p>If the incoming message contains &quot;LDDS75&quot;, it goes to output 1, if it contains &quot;AM319&quot; (which we haven&#x27;t set up yet), it goes to output 2, and any unknown devices go to the &quot;otherwise&quot; output where you can handle them (e.g., with a debug node to see what arrived).</p>
<p><img decoding="async" loading="lazy" alt="Configuring the switch node" src="/assets/images/node-red-switch-node-config-5e3cdaf12e435158d7b4a3196fb5c1fe.png" width="2762" height="968" class="img_ev3q"></p>
<p>Wire the <code>Parse JSON</code> node to the <code>Switch</code> node.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-function">5. Function<a href="#5-function" class="hash-link" aria-label="Direct link to 5. Function" title="Direct link to 5. Function">​</a></h4>
<p>Add a <strong>Function</strong> node for the LDDS75.  Function nodes are what allow us to correctly setup the data for insertion into InfluxDB.  A JSON node cleans up the data, the Switch node routes it to the correct sensor function, and a Function node formats it for InfluxDB.</p>
<p>Search for a <code>function</code> node and add it to your workspace.  The LDDS75 specs say it can measure from 280mm to 7500mm. You&#x27;ll want to modify the following function to match your tank size.  I&#x27;m using a 1200mm diameter, 1850mm height tank.</p>
<ul>
<li>Double-click to configure:<!-- -->
<ul>
<li>Name it <code>LDDS75 Function</code></li>
<li>Paste the following code into the <code>Message</code> tab of the Function node:</li>
</ul>
</li>
</ul>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Log receipt of message</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">warn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;LDDS75 function processing message&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> originalPayload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> gateway </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">rxInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Get the distance value first and validate it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> distance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">object</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">distance </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Validate distance reading (LDDS75 range: 280-7500mm for flat objects)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">distance </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> distance </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">280</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> distance </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7500</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">warn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Invalid distance reading: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> distance </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mm - outside LDDS75 range (280-7500mm)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Optional: Tank-specific validation (comment out or adjust as needed)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">MAX_TANK_HEIGHT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1850</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// adjust this to your tank height</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">distance </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">MAX_TANK_HEIGHT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">warn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Reading exceeds tank height: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> distance </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mm &gt; &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">MAX_TANK_HEIGHT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mm&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Create payload array with fields and tags objects</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">payload</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Sensor data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">distance</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> distance</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">battery</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseFloat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">object</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">battery_voltage </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">temperature</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseFloat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">object</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">temperature </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// RF metrics</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">rssi</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gateway</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">rssi</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">snr</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseFloat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gateway</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">snr</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">frequency</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">frequency </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">spreading_factor</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dr</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">bandwidth</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">modulation</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">lora</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">bandwidth </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Frame counter and port</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">frame_counter</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">fCnt</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">port</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">fPort</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Device info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">device</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">deviceInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">deviceName </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">device_eui</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">deviceInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">devEui </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">device_addr</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">devAddr</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">device_class</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">deviceInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">deviceClassEnabled </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">device_profile</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">deviceInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">deviceProfileName </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Application info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">application</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">deviceInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">applicationName </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">application_id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">deviceInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">applicationId </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Gateway info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">gateway</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gateway</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">metadata</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">gateway_name </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">gateway_id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gateway</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">gatewayId</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Network info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">region</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gateway</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">metadata</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">region_common_name </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">network</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gateway</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">metadata</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">network </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">tenant</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">deviceInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">tenantName </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Set measurement name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">measurement</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ldds75_metsci&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Add timestamp (convert to nanoseconds for InfluxDB)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> timestamp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Date</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalPayload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">time</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getTime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isNaN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">warn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Invalid timestamp&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">timestamp</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Log the attempt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">warn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Writing to InfluxDB - Device: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">device</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;, Distance: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> distance </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; mm&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;LDDS75 Processing Error: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed payload: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">status</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">fill</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;red&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">shape</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dot&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Processing Error&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Make sure you drag the wire from the correct connector on the Switch node (the top one, but you can hover over the node to see which connector is which) to the next node in the flow.  In this case, that&#x27;ll be our LDDS75 Function node.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="6-influxdb-out">6. InfluxDB out<a href="#6-influxdb-out" class="hash-link" aria-label="Direct link to 6. InfluxDB out" title="Direct link to 6. InfluxDB out">​</a></h4>
<p>Add an <strong>InfluxDB out</strong> node to the Function node to store the data in InfluxDB.</p>
<ul>
<li>Double-click the node to configure it.</li>
<li>Name the node <code>Local InfluxDB</code></li>
</ul>
<p>Click the <code>+</code> icon next to the &quot;Server&quot; field to create a new InfluxDB server configuration</p>
<ul>
<li>Fill in the InfluxDB server properties:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Name: [your org name, copy this from your credentials file]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Version: 2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">URL: http://localhost:8086</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Token: [paste in your InfluxDB token from your credentials file]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Leave other settings as is</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><code>Add</code> to save the server configuration</li>
</ul>
<p>Now, in the InfluxDB Out node configuration:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Name: Local InfluxDB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server: [should be the server you just set up]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Organization: [your org name, copy this from your credentials file]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bucket: sensors [also in the credentials file]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Measurement: [leave blank]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Time precision: `Nanoseconds` </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="Configuring the InfluxDB out node" src="/assets/images/node-red-influxdb-out-node-configure-312f78b9b42fa4ffe4dfd98b4a04e834.png" width="2366" height="1078" class="img_ev3q"></p>
<p>Click <code>Done</code> to save the node, then click <code>Deploy</code> in the top-right.</p>
<p><img decoding="async" loading="lazy" alt="Connecting the nodes" src="/assets/images/node-red-ldds-basic-flow-no-debug-76ced46c22f0ff2b3c561f3d83da2e8d.png" width="2580" height="492" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="7-debug">7. Debug<a href="#7-debug" class="hash-link" aria-label="Direct link to 7. Debug" title="Direct link to 7. Debug">​</a></h4>
<p>Now, the pro move here is to add in Debug nodes.  It&#x27;s not required, but it&#x27;s what I&#x27;ve done.  Add a Debug node to every one our regular nodes. That way we&#x27;ll see what&#x27;s going through the whole flow the next time we have a packet come through.</p>
<p>For all of those:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- Set Output to `msg.payload`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Name it something descriptive</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="8-deploy-and-test">8. Deploy and test<a href="#8-deploy-and-test" class="hash-link" aria-label="Direct link to 8. Deploy and test" title="Direct link to 8. Deploy and test">​</a></h4>
<p>With your flow set up, click <code>Deploy</code> in the top-right.</p>
<p><img decoding="async" loading="lazy" alt="Deploying the flow" src="/assets/images/node-red-flow-with-debug-deploy-5e7e43219b8e0519db44de420ef09eb2.png" width="3200" height="748" class="img_ev3q"></p>
<p>You should see a green bar and the word &quot;Deployed&quot; at the top of the screen.</p>
<p>Now go back to your LDDS75 and power it back on.  Since you set it to fire on a one minute interval, you&#x27;ll know quickly if everything is working or not as you&#x27;ll see the data start flowing through in the debug panel on the right side.</p>
<p>Remember, it might take a minute or two for the first join to complete and the data to start flowing.</p>
<p><img decoding="async" loading="lazy" alt="Connecting the nodes" src="/assets/images/node-red-first-flow-f13245cfad52cead06df3288de8c3b1b.png" width="3452" height="1200" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This modular structure makes it easy to add more sensors later. You can see I&#x27;ve added an AM319 sensor to the flow above in the image.  Each sensor follows the same basic pattern:</p><ul>
<li>HTTP In (receives data)</li>
<li>JSON parser</li>
<li>Switch (routes data to the correct sensor function)<!-- -->
<ul>
<li>Sensor Function (formats data for your needs)</li>
</ul>
</li>
<li>InfluxDB out (stores data)</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-influxdb-check">B. InfluxDB Check<a href="#b-influxdb-check" class="hash-link" aria-label="Direct link to B. InfluxDB Check" title="Direct link to B. InfluxDB Check">​</a></h3>
<p>Let&#x27;s check our InfluxDB to see if the data made it there.  Go to <code>http://your-pi:8086</code> and sign in with the credentials from your installation.</p>
<p>Go to <code>Data Explorer</code> (the graphy icon on the left menu) and run a query for <code>ldds75</code> by pasting in the query below and hitting &quot;Submit&quot;.  Hit the <code>View Raw Data</code> button (not circled in the image).  You should see your data there.</p>
<p><img decoding="async" loading="lazy" alt="InfluxDB query" src="/assets/images/influxdb-data-explorer-130676423c521e55a7d42ae30e19ce6b.png" width="3848" height="1566" class="img_ev3q"></p>
<p>Here are three script queries you can use. These use my <code>DEVICE NAME</code>, in this case <code>LDDS 3</code>, so <strong>make sure you change that to your own</strong>.</p>
<p>The first query gives you the basic distance to liquid surface:</p>
<div class="language-flux codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-flux codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from(bucket: &quot;sensors&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; range(start: -24h)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;_measurement&quot;] == &quot;ldds75_metsci&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;device&quot;] == &quot;LDDS 3&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;_field&quot;] == &quot;distance&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; keep(columns: [&quot;_time&quot;, &quot;_value&quot;, &quot;device&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; yield(name: &quot;mm_to_surface&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I built 2 more queries to see my data using my barrel size (1200mm diameter, 1850mm height).</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>A quick note here on metric.  I&#x27;m a slowly-converting-to-metric American, so while I&#x27;ll use mm for distance, I&#x27;ll convert to gallons for volume.  Sorry, old habits die hard.</p></div></div>
<p>First, I&#x27;ll check the current water volume in gallons, again using my <code>DEVICE NAME</code>, in this case <code>LDDS 3</code>:</p>
<div class="language-flux codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-flux codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from(bucket: &quot;sensors&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; range(start: -24h)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;_measurement&quot;] == &quot;ldds75_metsci&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;device&quot;] == &quot;LDDS 3&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;_field&quot;] == &quot;distance&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; map(fn: (r) =&gt; ({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       r with _value: float(v: 3.14159) * ((600.0/1000.0) ^ 2.0) * (1850.0 - float(v: r._value))/1000.0 * 264.172</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     }))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; keep(columns: [&quot;_time&quot;, &quot;_value&quot;, &quot;device&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; yield(name: &quot;gallons&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here&#x27;s another query you could use that would also pull the gateway name that&#x27;s receiving your data,as well as the distance and RSSI fields.  You might use this to keep track of what kind of coverage you&#x27;re getting from a given gateway.</p>
<div class="language-flux codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-flux codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from(bucket: &quot;sensors&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; range(start: -24h)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;_measurement&quot;] == &quot;ldds75_metsci&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;gateway&quot;] == &quot;dancing-daffodil-cheetah&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;region&quot;] == &quot;US915&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;_field&quot;] == &quot;distance&quot; or r[&quot;_field&quot;] == &quot;rssi&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; keep(columns: [&quot;_time&quot;, &quot;_value&quot;, &quot;_field&quot;, &quot;device&quot;, &quot;gateway&quot;])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>These are all fairly simple queries, but you may still have problems.  We&#x27;re nerds, and nerd stuff usually don&#x27;t work right the first time.  That&#x27;s OK.  If you have problems, start by checking to make sure your queries in InfluxDB match your Device Names, Gateway, and Region.  If you just copy/paste exactly what I put, you&#x27;re not going to see anything because it&#x27;ll be looking for my <code>DEVICE NAME</code>, in this case <code>LDDS 3</code>.  By far the fastest way to debug on your own is to feed in messages from Node-RED debug and InfluxDB,  and drop screenshots into ChatGPT/Cursor/Grok etc.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="c-grafana-dashboards">C. Grafana Dashboards<a href="#c-grafana-dashboards" class="hash-link" aria-label="Direct link to C. Grafana Dashboards" title="Direct link to C. Grafana Dashboards">​</a></h3>
<p>Now let&#x27;s head over to Grafana and set up a dashboard, woohoo!</p>
<p>Go to the local Grafana at <code>http://your-pi:3000</code> and sign in with the credentials from your installation.  You&#x27;ll see something like this after you sign in:</p>
<p><img decoding="async" loading="lazy" alt="Grafana dashboard" src="/assets/images/grafana-home-78da1abadacb5c1b0a1c23ee771a2335.png" width="3332" height="1204" class="img_ev3q"></p>
<p>Now that we have data flowing into InfluxDB, let&#x27;s visualize it in Grafana! First, we&#x27;ll connect Grafana to our InfluxDB data source.</p>
<ol>
<li>Click <strong>Connections</strong> in the left-side menu</li>
<li>Click <strong>Add new connection</strong></li>
<li>Search for <code>InfluxDB</code> and select it</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Adding a new InfluxDB connection" src="/assets/images/grafana-connections-influxdb-70aa66f6b6c0a093306f546b35abe717.png" width="3146" height="1026" class="img_ev3q"></p>
<ol start="4">
<li>
<p>Click <strong>Add new data source</strong></p>
</li>
<li>
<p>Configure the following settings, leaving everything else as is:</p>
<p><strong>Basic Settings:</strong></p>
<ul>
<li>Name: <code>Local InfluxDB</code></li>
<li>Default: ✓ (checked)</li>
</ul>
<p><strong>Query Language:</strong></p>
<ul>
<li>Select: <code>Flux</code>
(You&#x27;ll see a note that Flux support is in beta - that&#x27;s okay!)</li>
</ul>
<p><strong>HTTP Settings:</strong></p>
<ul>
<li>URL: <code>http://&lt;YOUR-PI-IP&gt;:8086</code></li>
</ul>
<p><strong>Auth:</strong></p>
<ul>
<li>Basic auth: Toggle ON</li>
<li>With Credentials: Toggle ON</li>
<li>User: [your InfluxDB username]</li>
<li>Password: [your InfluxDB password]</li>
</ul>
<p><strong>InfluxDB Details:</strong></p>
<ul>
<li>Organization: [your org name from credentials file]</li>
<li>Token: [paste your token from credentials file]</li>
<li>Default Bucket: <code>sensors</code></li>
<li>Min time interval: <code>10s</code></li>
<li>Max series: <code>1000</code></li>
</ul>
</li>
<li>
<p>Click <strong>Save &amp; test</strong> at the bottom
You should see &quot;Data source is working&quot; if everything is configured correctly</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Grafana InfluxDB connection setup" src="/assets/images/grafana-influxdb-settings-4e8cb2a20280d8a93e613fd2afd55050.png" width="2472" height="1166" class="img_ev3q"></p>
<p>Now let&#x27;s create a dashboard to visualize our LDDS75 data.</p>
<p><img decoding="async" loading="lazy" alt="Grafana add new dashboard" src="/assets/images/grafana-build-new-dashboard-9b5e8e14d2afca56f4308cc8e71dff02.png" width="1866" height="700" class="img_ev3q"></p>
<ol>
<li>Click the <strong>+</strong> icon up at the top right</li>
<li>Select <strong>New Dashboard</strong></li>
<li>Click <strong>Add visualization</strong></li>
<li>Select your <code>Local InfluxDB</code> data source</li>
<li>In the Flux Query editor, paste the following, making sure you replace <code>LDDS 3</code> with your own device name:</li>
</ol>
<div class="language-flux codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-flux codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from(bucket: &quot;sensors&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; range(start: -4h)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;_measurement&quot;] == &quot;ldds75_metsci&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;device&quot;] == &quot;LDDS 3&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; filter(fn: (r) =&gt; r[&quot;_field&quot;] == &quot;distance&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; keep(columns: [&quot;_time&quot;, &quot;_value&quot;, &quot;device&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; last()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&gt; yield(name: &quot;distance&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, over on the right, we&#x27;re going to configure the visualization settings.</p>
<p>The type of visualization we&#x27;re going to use is a <code>Time Series</code> graph.  This is ideal for showing changes over time.</p>
<p><img decoding="async" loading="lazy" alt="Grafana Time Series" src="/assets/images/grafana-initial-setup-55e5f0fce100f2f2529b071b9220bcc3.png" width="2906" height="1448" class="img_ev3q"></p>
<p>At the top right, select <code>Time series</code>.</p>
<ol start="6">
<li>
<p><code>Panel Options</code></p>
<ul>
<li>Title: &quot;Water Level&quot;</li>
<li>Description: &quot;Current distance to liquid surface&quot;</li>
</ul>
</li>
<li>
<p><code>Value Options</code></p>
<ul>
<li>Calculate: &quot;Last *&quot;</li>
<li>Fields: Select &quot;Numeric Fields&quot; only</li>
</ul>
</li>
<li>
<p><code>Standard Options</code></p>
<ul>
<li>Unit: Distance → millimeters (mm)</li>
<li>Min: 0</li>
<li>Max: 8500 (this is the max, adjust based on your tank size)</li>
<li>Decimals: 0 (millimeters don&#x27;t need decimals)</li>
</ul>
</li>
<li>
<p><code>Thresholds</code></p>
<ul>
<li>Add threshold at 80% of your maximum expected water level</li>
<li>Base color: Green</li>
<li>Above 80%: Red (indicates barrel is getting full)</li>
</ul>
</li>
<li>
<p>Save your dashboard, then leave the edit window and go <code>Back to dashboard</code>.</p>
</li>
</ol>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>The <code>keep(columns: [&quot;_time&quot;, &quot;_value&quot;, &quot;device&quot;])</code> in the query is crucial - it prevents duplicate gauges by stripping unnecessary tags while maintaining the essential data for display.</p></div></div>
<p>Now let&#x27;s do a little admin work, then set up the sharing aspect.  Grafana makes this dead easy.</p>
<p>First, in your Pi Terminal:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo nano /etc/grafana/grafana.ini</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You&#x27;ll see the full file, modify/add the following, <strong>replacing the domain and subdomain with your own as appropriate</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[server]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">domain = grafana.gristleking.dev </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root_url = https://grafana.gristleking.dev </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[security]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">allow_embedding = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Save &amp; close with <code>Ctrl+X</code>, then <code>Y</code>, then <code>Enter</code>.</p>
<p>Now restart Grafana:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl restart grafana-server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Back in Grafana, <code>Save</code> your dashboard, refresh the page, then <code>Exit Edit</code></p>
<p>Click the Share button in the top right.  Go to the <code>Public Dashboard</code> tab</p>
<p><img decoding="async" loading="lazy" alt="Grafana Share Dashboard" src="/assets/images/grafana-share-dashboard-00feca51837db213b24a3d1e697e646b.png" width="3128" height="1376" class="img_ev3q"></p>
<p>Check all the boxes, then click <code>Generate Public URL</code>.  It should generate a URL like <code>https://grafana.&lt;YOUR-DOMAIN&gt;&gt;.dev/d/000000002/ldds75-metsci-dashboard?orgId=1&amp;var-device=LDDS%202</code>.</p>
<p>Copy the URL and paste it into your browser, or share it with your Mom.  Now everybody can see how much water is in your tank.  Bam, you&#x27;re public!</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="d-fun-with-monitoring--triggers">D. Fun with Monitoring &amp; Triggers<a href="#d-fun-with-monitoring--triggers" class="hash-link" aria-label="Direct link to D. Fun with Monitoring &amp; Triggers" title="Direct link to D. Fun with Monitoring &amp; Triggers">​</a></h3>
<p>We&#x27;re now finished with the bulk of this tutorial.  You&#x27;ve got a dashboard, you&#x27;ve got data flowing into InfluxDB, and you&#x27;ve got a way to share it with the world.  From here, you can add more sensors, build more complex dashboards, or string together new Node-RED flows to trigger alerts or other actions.  Following are a few examples of what you could do next.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-indoor-environment-monitoring">1. Indoor Environment Monitoring<a href="#1-indoor-environment-monitoring" class="hash-link" aria-label="Direct link to 1. Indoor Environment Monitoring" title="Direct link to 1. Indoor Environment Monitoring">​</a></h4>
<p>Liquid level sensing is simple, but generally not that exciting, so...</p>
<p>Using the steps above, I&#x27;ve added in a Milesight AM319, including an Applicaton and Policy in Cloudflare and a second dashboard.  This is what it looks like with some live data:</p>
<p><img decoding="async" loading="lazy" alt="Grafana AM319 Dashboard" src="/assets/images/grafana-am319-burpees-f5901472e051262896e6c35183535ba9.png" width="2528" height="1538" class="img_ev3q"></p>
<p>Just so you could see some real change,I closed up all the windows &amp; doors in my office and did burpees until the CO2 went up.  You can also see where we dropped a couple of packets.  The AM319 fires a huge packet every minute, so it&#x27;s easy to see where the packets are dropped.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Download My Node-RED Flow</div><div class="admonitionContent_BuS1"><p>Want to skip the manual setup? You can download the complete LDDS75 flow here and import it directly into Node-RED.</p><div class="centered-button-container"><a href="/flows/MetSci-LDDS75-flow.json" class="download-button" download="">Download  LDDS75 Flow</a></div><p>After downloading:</p><ol>
<li>Configure your InfluxDB credentials</li>
<li>Update any device-specific information</li>
<li>Deploy the flow after importing</li>
</ol></div></div>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-home-assistant-integration">2. Home Assistant Integration<a href="#2-home-assistant-integration" class="hash-link" aria-label="Direct link to 2. Home Assistant Integration" title="Direct link to 2. Home Assistant Integration">​</a></h4>
<p>If you&#x27;re using <a href="https://www.home-assistant.io/" target="_blank" rel="noopener noreferrer">Home Assistant</a> you can use Node-RED on the Pi to pipe in data from the dashboard you just set up to Home Assistant.</p>
<p>Installing and configuring HA is well beyond the scope of this tutorial, but for those of you who already have it running and want to pipe in data from your shiny new MetSci setup, here&#x27;s how you can do it:</p>
<ol>
<li>
<p>Install the Home Assistant nodes in Node-RED on your MetSci Pi:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd ~/.node-red</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm install node-red-contrib-home-assistant-websocket</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>In Node-RED, add and configure the <code>home-assistant</code> config node:</p>
<ul>
<li>Protocol: <code>http</code> or <code>https</code> (depending on your HA setup)</li>
<li>Base URL: <code>http://YOUR_HA_IP:8123</code> (or your external URL)</li>
<li>Access Token: Create a Long-Lived Access Token in HA
(HA Profile → Long-Lived Access Tokens → Create Token)</li>
</ul>
</li>
<li>
<p>Add a <code>call-service</code> node after your LDDS75 Function node:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">Domain</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> sensor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">Service</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> set_state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Entity</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> sensor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">water_level</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">Data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">state</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">distance</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">attributes</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">unit_of_measurement</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mm&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">friendly_name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Water Level&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">device_class</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;distance&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">battery_level</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">battery</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Restart Home Assistant to apply changes</p>
</li>
</ol>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Security Considerations</div><div class="admonitionContent_BuS1"><p>When connecting services across devices:</p><ol>
<li>Use strong, unique passwords and tokens</li>
<li>Consider setting up a VPN if accessing over the internet</li>
<li>Use SSL/TLS when possible</li>
<li>Limit firewall rules to specific IPs</li>
<li>Monitor logs for unauthorized access attempts</li>
</ol></div></div>
<p><em><strong>Example Lovelace Card</strong></em>
Add this to your Lovelace dashboard in Home Assistant:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> vertical</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">cards</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gauge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Water Level</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">entity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sensor.water_level</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">min</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">max</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">severity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">green</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">yellow</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">800</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">red</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> history</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">graph</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Water Level History</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">entities</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">entity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sensor.water_level</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Level</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-class-c-integration">3. Class C Integration<a href="#3-class-c-integration" class="hash-link" aria-label="Direct link to 3. Class C Integration" title="Direct link to 3. Class C Integration">​</a></h4>
<p>I&#x27;ve talked about how to use Class C in the <a href="/docs/tutorial-extras/class_C_kuando_busylight">MetSci Class C via API tutorial</a>.  You could use that, or you can use Node-RED to pipe data from the LDDS75 to your Class C device, in my case, a Kuando Busylight.</p>
<p>Since you&#x27;ve already set up Node-RED, I&#x27;ll just share the flow I built for mine.</p>
<div class="centered-button-container"><a href="/flows/MetSci-Busylight-Trigger-flow.json" class="download-button" download="">Download Busylight Trigger Flow</a></div>
<p>It&#x27;ll look like this:</p>
<p><img decoding="async" loading="lazy" alt="Node-RED Busylight Trigger" src="/assets/images/node-red-busylight-trigger-flow-1dddb3b4f9d385b8e9570e5d94b72902.png" width="2762" height="632" class="img_ev3q"></p>
<p>Setting that up will check the LDDS75 distance measurements in the InfluxDB every 15 minutes, then flash your Busylight red 5 times on a 1 second interval every 15 minutes when the tank is full (distance of 120mm or less) until you turn the Node-RED alert off or the tank is no longer full.</p>
<p>Let your imagination run wild!  You could also use this to trigger other actions, like sending an email, triggering a Home Assistant automation, or even triggering a Class C device to send a message:</p>
<p><code>Airstrikes required on unknown vehicle parked in &quot;MY&quot; parking spot</code></p>
<p>Just kidding, airstrikes triggered by a LoRaWAN device are for war, not parking violations.  But...we&#x27;re American, so maybe we can make an execption. 😉</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-system-maintenance--troubleshooting">7. System Maintenance &amp; Troubleshooting<a href="#7-system-maintenance--troubleshooting" class="hash-link" aria-label="Direct link to 7. System Maintenance &amp; Troubleshooting" title="Direct link to 7. System Maintenance &amp; Troubleshooting">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-credentials-management">A. Credentials Management<a href="#a-credentials-management" class="hash-link" aria-label="Direct link to A. Credentials Management" title="Direct link to A. Credentials Management">​</a></h3>
<p>Your credentials are stored in several locations:</p>
<ol>
<li>Node-RED: <code>~/.node-red/settings.js</code></li>
<li>InfluxDB: <code>/var/lib/influxdb/influxd.bolt</code> (and <code>/var/lib/influxdb/engine/</code>)</li>
<li>Grafana: <code>/etc/grafana/grafana.ini</code></li>
<li>Installation credentials: Generated in <code>~/metsci-credentials.txt</code></li>
</ol>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>After setting up your services, securely store the contents of <code>~/metsci-credentials.txt</code> somewhere safe, then delete it from your Pi:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rm ~/metsci-credentials.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-backing-up-configurations">B. Backing Up Configurations<a href="#b-backing-up-configurations" class="hash-link" aria-label="Direct link to B. Backing Up Configurations" title="Direct link to B. Backing Up Configurations">​</a></h3>
<p>Create a backup script for your configurations:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BACKUP_DIR=&quot;/mnt/ssd/backups/$(date +%Y%m%d)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p $BACKUP_DIR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Backup Node-RED flows and settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp -r ~/.node-red/* $BACKUP_DIR/node-red/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Backup service configs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp -r /var/lib/influxdb $BACKUP_DIR/influxdb/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp /etc/grafana/grafana.ini $BACKUP_DIR/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Set permissions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown -R $USER:$USER $BACKUP_DIR</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="c-system-updates">C. System Updates<a href="#c-system-updates" class="hash-link" aria-label="Direct link to C. System Updates" title="Direct link to C. System Updates">​</a></h3>
<p>Regular maintenance tasks:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Update system packages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt update &amp;&amp; sudo apt upgrade -y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Restart services after updates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl restart nodered influxdb grafana-server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="d-troubleshooting-guide">D. Troubleshooting Guide<a href="#d-troubleshooting-guide" class="hash-link" aria-label="Direct link to D. Troubleshooting Guide" title="Direct link to D. Troubleshooting Guide">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-service-not-starting">1. Service Not Starting<a href="#1-service-not-starting" class="hash-link" aria-label="Direct link to 1. Service Not Starting" title="Direct link to 1. Service Not Starting">​</a></h4>
<p>Check service status:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl status [service-name]  # nodered, influxdb, or grafana-server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>View logs:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo journalctl -u [service-name] -n 50 --no-pager</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-lost-connection-to-pi">2. Lost Connection to Pi<a href="#2-lost-connection-to-pi" class="hash-link" aria-label="Direct link to 2. Lost Connection to Pi" title="Direct link to 2. Lost Connection to Pi">​</a></h4>
<ol>
<li>Check if Pi is powered on</li>
<li>Verify network connection</li>
<li>Try direct connection via ethernet</li>
<li>Check Cloudflare tunnel status:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl status cloudflared</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-data-not-flowing">3. Data Not Flowing<a href="#3-data-not-flowing" class="hash-link" aria-label="Direct link to 3. Data Not Flowing" title="Direct link to 3. Data Not Flowing">​</a></h4>
<p>Check each step:</p>
<ol>
<li>MetSci LNS → View device events in console</li>
<li>Cloudflare → Check tunnel logs</li>
<li>Node-RED → Check debug tab</li>
<li>InfluxDB → Test token and query recent data:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Test token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -v &quot;http://localhost:8086/api/v2/write?org=YOUR_ORG&amp;bucket=sensors&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &quot;Authorization: Token YOUR_TOKEN&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d &quot;test,host=test value=1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>Grafana → Check data source connection</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-disk-space-issues">4. Disk Space Issues<a href="#4-disk-space-issues" class="hash-link" aria-label="Direct link to 4. Disk Space Issues" title="Direct link to 4. Disk Space Issues">​</a></h4>
<p>Monitor disk usage:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df -h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```Check service logs taking up space:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo du -h /var/log | sort -rh | head -n 10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Recovery Steps</div><div class="admonitionContent_BuS1"><p>If something goes wrong:</p><ol>
<li>Check the relevant service status</li>
<li>Review the logs</li>
<li>Restore from backup if needed</li>
<li>If nothing else works, you can always reinstall the affected service</li>
</ol></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-la-ultima">8. La Ultima<a href="#8-la-ultima" class="hash-link" aria-label="Direct link to 8. La Ultima" title="Direct link to 8. La Ultima">​</a></h2>
<p>Last step?  <a href="https://grafana.meteoscientific.com/public-dashboards/e6bd9074e3ad4fad935bbcacb510059b" target="_blank" rel="noopener noreferrer">Here&#x27;s the dashbboard</a> I built for MeteoScientific, combining the rain barrel data with weather station data.</p>
<p>I&#x27;d love to see what you do!  Please tag us on X <a href="https://x.com/meteoscientific" target="_blank" rel="noopener noreferrer">MeteoScientific</a> and <a href="https://x.com/thegristleking" target="_blank" rel="noopener noreferrer">Gristleking</a> we&#x27;d love to see what you&#x27;ve done!</p>
<p><img decoding="async" loading="lazy" alt="Nik throwing the horns on a fully installed LDDS75 sensor" src="/assets/images/nik-throwing-the-horns-on-a-fully-installed-ldds75-sensor-using-helium-28a392bdab963bab830d170417415e0a.JPG" width="4032" height="3024" class="img_ev3q"></p>
<p>This tutorial was made possible by a generous grant from the Helium Foundation&#x27;s IOTWG; huge thanks to them for the support.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/gristlekinginc/metsci-site-v2/tree/main/docs/tutorial-extras/004-metsci-demo-dash.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/tutorial-extras/Google_Sheets"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Integrating Google Sheets</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/tutorial-extras/spreading-factor-chirps"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Spreading Factor &amp; Chirps</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#get-after-it" class="table-of-contents__link toc-highlight">Get After It</a></li><li><a href="#a-hardware" class="table-of-contents__link toc-highlight">A. Hardware</a></li><li><a href="#b-not-hardware" class="table-of-contents__link toc-highlight">B. Not-Hardware</a></li><li><a href="#c-notes-on-what-you-need" class="table-of-contents__link toc-highlight">C. Notes on what you &quot;Need&quot;</a></li><li><a href="#1-set-up-overview" class="table-of-contents__link toc-highlight">1. Set Up Overview</a></li><li><a href="#2-setting-up-your-rasbperry-pi" class="table-of-contents__link toc-highlight">2. <strong>Setting Up Your Rasbperry Pi</strong></a><ul><li><a href="#a-basic-setup" class="table-of-contents__link toc-highlight">A. Basic Setup</a></li><li><a href="#b-securing-your-pi" class="table-of-contents__link toc-highlight">B. Securing Your Pi</a></li></ul></li><li><a href="#3-install-services-node-red-influxdb-grafana" class="table-of-contents__link toc-highlight">3. <strong>Install Services (Node-RED, InfluxDB, Grafana)</strong></a><ul><li><a href="#a-service-install-script" class="table-of-contents__link toc-highlight">A. Service Install Script</a></li><li><a href="#b-integrate-external-ssd" class="table-of-contents__link toc-highlight">B. Integrate External SSD</a></li></ul></li><li><a href="#4-cloudflare-tunnels-applications-and-tokens" class="table-of-contents__link toc-highlight">4. <strong>Cloudflare:</strong> Tunnels, Applications, and Tokens</a><ul><li><a href="#a-set-up-zero-trust" class="table-of-contents__link toc-highlight">A. Set Up Zero Trust</a></li><li><a href="#b-zero-trust-token--application-setup" class="table-of-contents__link toc-highlight">B. Zero Trust Token &amp; Application Setup</a></li><li><a href="#c-zero-trust-applications" class="table-of-contents__link toc-highlight">C. Zero Trust Applications</a></li><li><a href="#d-prepare-your-pi-for-cloudflare" class="table-of-contents__link toc-highlight">D. Prepare Your Pi for Cloudflare</a></li><li><a href="#e-create-a-tunnel-in-cloudflare-zero-trust" class="table-of-contents__link toc-highlight">E. Create a Tunnel In Cloudflare Zero Trust</a></li><li><a href="#f-add-the-tunnel-to-your-raspberry-pi" class="table-of-contents__link toc-highlight">F. Add The Tunnel To Your Raspberry Pi</a></li><li><a href="#g-setting-up-public-hostnames" class="table-of-contents__link toc-highlight">G. Setting Up Public Hostnames</a></li><li><a href="#h-document-your-public-hostnames" class="table-of-contents__link toc-highlight">H. Document Your Public Hostnames</a></li></ul></li><li><a href="#5-setting-up-your-ldds-75-sensor" class="table-of-contents__link toc-highlight">5. <strong>Setting Up Your LDDS 75 Sensor</strong></a><ul><li><a href="#a-provision-that-sucker" class="table-of-contents__link toc-highlight">A. Provision That Sucker!</a></li><li><a href="#b-check-link-metrics" class="table-of-contents__link toc-highlight">B. Check Link Metrics</a></li><li><a href="#c-configure-for-fast-firing" class="table-of-contents__link toc-highlight">C. Configure For Fast Firing</a></li><li><a href="#d-set-up-the-http-integration-in-metsci" class="table-of-contents__link toc-highlight">D. Set Up The HTTP Integration In MetSci</a></li></ul></li><li><a href="#6-local-integration-setup" class="table-of-contents__link toc-highlight">6. <strong>Local Integration Setup</strong></a><ul><li><a href="#a-node-red-flows" class="table-of-contents__link toc-highlight">A. Node-RED Flows</a></li><li><a href="#b-influxdb-check" class="table-of-contents__link toc-highlight">B. InfluxDB Check</a></li><li><a href="#c-grafana-dashboards" class="table-of-contents__link toc-highlight">C. Grafana Dashboards</a></li><li><a href="#d-fun-with-monitoring--triggers" class="table-of-contents__link toc-highlight">D. Fun with Monitoring &amp; Triggers</a></li></ul></li><li><a href="#7-system-maintenance--troubleshooting" class="table-of-contents__link toc-highlight">7. System Maintenance &amp; Troubleshooting</a><ul><li><a href="#a-credentials-management" class="table-of-contents__link toc-highlight">A. Credentials Management</a></li><li><a href="#b-backing-up-configurations" class="table-of-contents__link toc-highlight">B. Backing Up Configurations</a></li><li><a href="#c-system-updates" class="table-of-contents__link toc-highlight">C. System Updates</a></li><li><a href="#d-troubleshooting-guide" class="table-of-contents__link toc-highlight">D. Troubleshooting Guide</a></li></ul></li><li><a href="#8-la-ultima" class="table-of-contents__link toc-highlight">8. La Ultima</a></li></ul></div></div></div></div></main></div></div></div><footer class="customFooter_NXws"><div class="footerContainer_igk0"><div class="footerBrand_RWjd"><img src="/img/ms_pro_lettertype_white.svg" alt="MeteoScientific" class="footerLogo_WEju"><p class="footerTagline_dBE0">The Business of LoRaWAN</p></div><div class="footerLinksGrid_IeDx"><div class="footerSection_RewS"><h3 class="footerSectionTitle_cYZe"><span class="footerSectionIcon__R8l">📚</span>Docs</h3><ul class="footerLinksList_B8PY"><li class="footerLinkItem_YEaM"><a class="footerLink_Gwpa" href="/docs/tutorial-basics/LoRaWAN-Big-Picture"><span class="footerLinkIcon_quTl">🎓</span>Tutorials</a></li><li class="footerLinkItem_YEaM"><a href="https://www.youtube.com/@meteoscientific" class="footerLink_Gwpa" target="_blank" rel="noopener noreferrer"><span class="footerLinkIcon_quTl">📺</span>YouTube</a></li><li class="footerLinkItem_YEaM"><a href="/blog" class="footerLink_Gwpa" target="_blank" rel="noopener noreferrer"><span class="footerLinkIcon_quTl">📝</span>Blog</a></li></ul></div><div class="footerSection_RewS"><h3 class="footerSectionTitle_cYZe"><span class="footerSectionIcon__R8l">⚡</span>Moar</h3><ul class="footerLinksList_B8PY"><li class="footerLinkItem_YEaM"><a class="footerLink_Gwpa" href="/about"><span class="footerLinkIcon_quTl">🏢</span>About</a></li><li class="footerLinkItem_YEaM"><a href="/faq" class="footerLink_Gwpa" target="_blank" rel="noopener noreferrer"><span class="footerLinkIcon_quTl">❓</span>FAQ</a></li><li class="footerLinkItem_YEaM"><a class="footerLink_Gwpa" href="/podcast"><span class="footerLinkIcon_quTl">🎙️</span>Podcast</a></li></ul></div><div class="footerSection_RewS"><h3 class="footerSectionTitle_cYZe"><span class="footerSectionIcon__R8l">👥</span>Community</h3><ul class="footerLinksList_B8PY"><li class="footerLinkItem_YEaM"><a href="https://discord.gg/4fR5QAq6Vc" class="footerLink_Gwpa" target="_blank" rel="noopener noreferrer"><span class="footerLinkIcon_quTl">💬</span>Discord</a></li><li class="footerLinkItem_YEaM"><a href="https://x.com/meteoscientific" class="footerLink_Gwpa" target="_blank" rel="noopener noreferrer"><span class="footerLinkIcon_quTl">🐦</span>X</a></li><li class="footerLinkItem_YEaM"><a href="/donate" class="footerLink_Gwpa" target="_blank" rel="noopener noreferrer"><span class="footerLinkIcon_quTl">💝</span>Donate</a></li></ul></div><div class="footerSection_RewS"><h3 class="footerSectionTitle_cYZe"><span class="footerSectionIcon__R8l">👑</span>Owned By</h3><ul class="footerLinksList_B8PY"><li class="footerLinkItem_YEaM"><a href="https://x.com/thegristleking" target="_blank" rel="noopener noreferrer" class="footerLink_Gwpa"><span class="footerLinkIcon_quTl">🔗</span>X</a></li><li class="footerLinkItem_YEaM"><a href="https://www.linkedin.com/in/nikhawks/" class="footerLink_Gwpa" target="_blank" rel="noopener noreferrer"><span class="footerLinkIcon_quTl">💼</span>LinkedIn</a></li></ul></div><div class="footerSection_RewS"><h3 class="footerSectionTitle_cYZe"><span class="footerSectionIcon__R8l">🔧</span>Resources</h3><ul class="footerLinksList_B8PY"><li class="footerLinkItem_YEaM"><a class="footerLink_Gwpa" href="/media"><span class="footerLinkIcon_quTl">🎨</span>Media Assets</a></li><li class="footerLinkItem_YEaM"><a class="footerLink_Gwpa" href="/email-sign-up"><span class="footerLinkIcon_quTl">📧</span>Email Sign Up</a></li><li class="footerLinkItem_YEaM"><a class="footerLink_Gwpa" href="/contact"><span class="footerLinkIcon_quTl">📞</span>Contact</a></li></ul></div></div><div class="footerBottom_YdiN"><p class="footerCopyright_IOOq">Copyright © <!-- -->2025<!-- --> MeteoScientific.<a class="footerLegalLink_FETy" href="/terms-of-service">Terms</a> |<a class="footerLegalLink_FETy" href="/privacy-policy">Privacy</a></p></div></div></footer></div>
</body>
</html>